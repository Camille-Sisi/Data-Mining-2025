<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Manipulation des variables | DATA MINING</title>
  <meta name="description" content="Titre du cours" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Manipulation des variables | DATA MINING" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Titre du cours" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Manipulation des variables | DATA MINING" />
  
  <meta name="twitter:description" content="Titre du cours" />
  

<meta name="author" content="Camille Signoretto, Maîtresse de conférences en économie, Université Paris Cité" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="02-Manipulation-base.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/tidyverse.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">


      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DATA MINING</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="c03-Manipulation-variables" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Section 3</span> Manipulation des variables<a href="03-Manipulation-variables.html#c03-Manipulation-variables" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div align="justify">
<p>Dans la manipulation des variables, l’une des premières choses à réaliser est de les définir dans le bon format, variables quantitatives/continues ou variables qualitatives/catégorielles.</p>
<p>On l’a vu dans la section précédente, certaines variables sont encore codées comme des nombres entiers (“integer”) alors que ce sont des variables catégorielles. On va donc corriger cela en regardant d’abord quelles variables sont concernées, en les sélectionnant avec <code>select_if()</code> ou <code>select(where())</code> :</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="03-Manipulation-variables.html#cb16-1" tabindex="-1"></a>RP_final <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="03-Manipulation-variables.html#cb16-2" tabindex="-1"></a>  <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="03-Manipulation-variables.html#cb16-3" tabindex="-1"></a>  <span class="fu">names</span>()</span></code></pre></div>
<pre><code> [1] &quot;AGED&quot;      &quot;AGER20&quot;    &quot;AGEREV&quot;    &quot;AGEREVQ&quot;   &quot;ANAI&quot;      &quot;CATPC&quot;    
 [7] &quot;COUPLE&quot;    &quot;CS1&quot;       &quot;DEPT&quot;      &quot;ETUD&quot;      &quot;IMMI&quot;      &quot;INAI&quot;     
[13] &quot;INATC&quot;     &quot;IPONDI&quot;    &quot;MOCO&quot;      &quot;MODV&quot;      &quot;NAIDT&quot;     &quot;ORIDT&quot;    
[19] &quot;REGION&quot;    &quot;SEXE&quot;      &quot;STAT_CONJ&quot; &quot;TACT&quot;      &quot;TACTD16&quot;  </code></pre>
<p>A part les variables d’âge <code>AGED</code> et <code>AGEREV</code>, de date de naissance <code>ANAI</code> et de pondération <code>IPONDI</code>, toutes les autres variables devraient en format “factor”. Deux façons de les transformer, soit vous changer les variables une à une en utilisant les fonctions <code>mutate()</code> et <code>as.factor()</code> ; soit vous créer une liste avec le nom des variables dont le format doit être transformer et vous utilisez la fonction <code>lapply()</code> en l’appliquant à cette liste de variables :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="03-Manipulation-variables.html#cb18-1" tabindex="-1"></a><span class="co"># 1ère méthode</span></span>
<span id="cb18-2"><a href="03-Manipulation-variables.html#cb18-2" tabindex="-1"></a><span class="co"># RP_final &lt;- RP_final %&gt;% mutate(AGER20=as.factor(AGER20),</span></span>
<span id="cb18-3"><a href="03-Manipulation-variables.html#cb18-3" tabindex="-1"></a><span class="co">#                                 AGEREVQ=as.factor(AGEREVQ),</span></span>
<span id="cb18-4"><a href="03-Manipulation-variables.html#cb18-4" tabindex="-1"></a><span class="co">#                                 CATPC=as.factor(CATPC),</span></span>
<span id="cb18-5"><a href="03-Manipulation-variables.html#cb18-5" tabindex="-1"></a><span class="co">#                                 COUPLE=as.factor(COUPLE),</span></span>
<span id="cb18-6"><a href="03-Manipulation-variables.html#cb18-6" tabindex="-1"></a><span class="co">#                                 CS1=as.factor(CS1),</span></span>
<span id="cb18-7"><a href="03-Manipulation-variables.html#cb18-7" tabindex="-1"></a><span class="co">#                                 DEPT=as.factor(DEPT),</span></span>
<span id="cb18-8"><a href="03-Manipulation-variables.html#cb18-8" tabindex="-1"></a><span class="co">#                                 ETUD=as.factor(ETUD),</span></span>
<span id="cb18-9"><a href="03-Manipulation-variables.html#cb18-9" tabindex="-1"></a><span class="co">#                                 IMMI=as.factor(IMMI),</span></span>
<span id="cb18-10"><a href="03-Manipulation-variables.html#cb18-10" tabindex="-1"></a><span class="co">#                                 INAI=as.factor(INAI),</span></span>
<span id="cb18-11"><a href="03-Manipulation-variables.html#cb18-11" tabindex="-1"></a><span class="co">#                                 INATC=as.factor(INATC),</span></span>
<span id="cb18-12"><a href="03-Manipulation-variables.html#cb18-12" tabindex="-1"></a><span class="co">#                                 MOCO=as.factor(MOCO),</span></span>
<span id="cb18-13"><a href="03-Manipulation-variables.html#cb18-13" tabindex="-1"></a><span class="co">#                                 MODV=as.factor(MODV),</span></span>
<span id="cb18-14"><a href="03-Manipulation-variables.html#cb18-14" tabindex="-1"></a><span class="co">#                                 NAIDT=as.factor(NAIDT),</span></span>
<span id="cb18-15"><a href="03-Manipulation-variables.html#cb18-15" tabindex="-1"></a><span class="co">#                                 ORIDT=as.factor(ORIDT),</span></span>
<span id="cb18-16"><a href="03-Manipulation-variables.html#cb18-16" tabindex="-1"></a><span class="co">#                                 REGION=as.factor(REGION),</span></span>
<span id="cb18-17"><a href="03-Manipulation-variables.html#cb18-17" tabindex="-1"></a><span class="co">#                                 SEXE=as.factor(SEXE),</span></span>
<span id="cb18-18"><a href="03-Manipulation-variables.html#cb18-18" tabindex="-1"></a><span class="co">#                                 STAT_CONJ=as.factor(STAT_CONJ),</span></span>
<span id="cb18-19"><a href="03-Manipulation-variables.html#cb18-19" tabindex="-1"></a><span class="co">#                                 TACT=as.factor(TACT),</span></span>
<span id="cb18-20"><a href="03-Manipulation-variables.html#cb18-20" tabindex="-1"></a><span class="co">#                                 TACTD16=as.factor(TACTD16))</span></span>
<span id="cb18-21"><a href="03-Manipulation-variables.html#cb18-21" tabindex="-1"></a></span>
<span id="cb18-22"><a href="03-Manipulation-variables.html#cb18-22" tabindex="-1"></a><span class="co"># 2nde méthode</span></span>
<span id="cb18-23"><a href="03-Manipulation-variables.html#cb18-23" tabindex="-1"></a>list_var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AGER20&quot;</span>, <span class="st">&quot;AGEREVQ&quot;</span>, <span class="st">&quot;CATPC&quot;</span>, <span class="st">&quot;COUPLE&quot;</span>, <span class="st">&quot;CS1&quot;</span>, <span class="st">&quot;DEPT&quot;</span>, <span class="st">&quot;ETUD&quot;</span>, <span class="st">&quot;IMMI&quot;</span>, <span class="st">&quot;INAI&quot;</span>, <span class="st">&quot;INATC&quot;</span>,</span>
<span id="cb18-24"><a href="03-Manipulation-variables.html#cb18-24" tabindex="-1"></a>              <span class="st">&quot;MOCO&quot;</span>, <span class="st">&quot;MODV&quot;</span>, <span class="st">&quot;NAIDT&quot;</span>, <span class="st">&quot;ORIDT&quot;</span>, <span class="st">&quot;REGION&quot;</span>, <span class="st">&quot;SEXE&quot;</span>, <span class="st">&quot;STAT_CONJ&quot;</span>, <span class="st">&quot;TACT&quot;</span>, <span class="st">&quot;TACTD16&quot;</span>)</span>
<span id="cb18-25"><a href="03-Manipulation-variables.html#cb18-25" tabindex="-1"></a>RP_final[, list_var] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(RP_final[, list_var], factor)</span></code></pre></div>
<p>On peut ensuite vérifier que ces variables sont bien des variables facteurs en regardant combien de modalités elles ont et quelles sont-elles. Par exemple, pour la variable <code>CATPC</code> :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="03-Manipulation-variables.html#cb19-1" tabindex="-1"></a><span class="fu">nlevels</span>(RP_final<span class="sc">$</span>CATPC)</span></code></pre></div>
<pre><code>[1] 3</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="03-Manipulation-variables.html#cb21-1" tabindex="-1"></a><span class="fu">levels</span>(RP_final<span class="sc">$</span>CATPC)</span></code></pre></div>
<pre><code>[1] &quot;0&quot; &quot;1&quot; &quot;2&quot;</code></pre>
<p>Si nous n’avions pas mis l’option transformant les variables caractères en variables facteurs lors du chargement des données, nous pourrions le faire maintenant en utilisant la fonction <code>mutate_if</code> ou la combinaison de <code>mutate</code> et <code>across(where())</code> comme ceci <code>RP %&gt;% mutate_if(is.character, as.factor)</code> ou <code>RP %&gt;% mutate(across(where(is.character), as.factor))</code>.</p>
<p>On peut enfin vérifier quelles sont les variables numériques qui restent :</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="03-Manipulation-variables.html#cb23-1" tabindex="-1"></a><span class="co"># RP_final %&gt;% select_if(is.numeric) %&gt;% head() %&gt;% gt()</span></span>
<span id="cb23-2"><a href="03-Manipulation-variables.html#cb23-2" tabindex="-1"></a>RP_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="jjjzuixtwp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jjjzuixtwp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jjjzuixtwp thead, #jjjzuixtwp tbody, #jjjzuixtwp tfoot, #jjjzuixtwp tr, #jjjzuixtwp td, #jjjzuixtwp th {
  border-style: none;
}

#jjjzuixtwp p {
  margin: 0;
  padding: 0;
}

#jjjzuixtwp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jjjzuixtwp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jjjzuixtwp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jjjzuixtwp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jjjzuixtwp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jjjzuixtwp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjjzuixtwp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jjjzuixtwp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jjjzuixtwp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jjjzuixtwp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jjjzuixtwp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jjjzuixtwp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jjjzuixtwp .gt_spanner_row {
  border-bottom-style: hidden;
}

#jjjzuixtwp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jjjzuixtwp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jjjzuixtwp .gt_from_md > :first-child {
  margin-top: 0;
}

#jjjzuixtwp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jjjzuixtwp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jjjzuixtwp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jjjzuixtwp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jjjzuixtwp .gt_row_group_first td {
  border-top-width: 2px;
}

#jjjzuixtwp .gt_row_group_first th {
  border-top-width: 2px;
}

#jjjzuixtwp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjjzuixtwp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jjjzuixtwp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jjjzuixtwp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjjzuixtwp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjjzuixtwp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jjjzuixtwp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jjjzuixtwp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jjjzuixtwp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jjjzuixtwp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jjjzuixtwp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjjzuixtwp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jjjzuixtwp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jjjzuixtwp .gt_left {
  text-align: left;
}

#jjjzuixtwp .gt_center {
  text-align: center;
}

#jjjzuixtwp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jjjzuixtwp .gt_font_normal {
  font-weight: normal;
}

#jjjzuixtwp .gt_font_bold {
  font-weight: bold;
}

#jjjzuixtwp .gt_font_italic {
  font-style: italic;
}

#jjjzuixtwp .gt_super {
  font-size: 65%;
}

#jjjzuixtwp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jjjzuixtwp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jjjzuixtwp .gt_indent_1 {
  text-indent: 5px;
}

#jjjzuixtwp .gt_indent_2 {
  text-indent: 10px;
}

#jjjzuixtwp .gt_indent_3 {
  text-indent: 15px;
}

#jjjzuixtwp .gt_indent_4 {
  text-indent: 20px;
}

#jjjzuixtwp .gt_indent_5 {
  text-indent: 25px;
}

#jjjzuixtwp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jjjzuixtwp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AGED">AGED</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="AGEREV">AGEREV</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="ANAI">ANAI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="IPONDI">IPONDI</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="AGED" class="gt_row gt_right">72</td>
<td headers="AGEREV" class="gt_row gt_right">72</td>
<td headers="ANAI" class="gt_row gt_right">1944</td>
<td headers="IPONDI" class="gt_row gt_right">3.360730</td></tr>
    <tr><td headers="AGED" class="gt_row gt_right">59</td>
<td headers="AGEREV" class="gt_row gt_right">58</td>
<td headers="ANAI" class="gt_row gt_right">1958</td>
<td headers="IPONDI" class="gt_row gt_right">3.668459</td></tr>
    <tr><td headers="AGED" class="gt_row gt_right">30</td>
<td headers="AGEREV" class="gt_row gt_right">29</td>
<td headers="ANAI" class="gt_row gt_right">1987</td>
<td headers="IPONDI" class="gt_row gt_right">3.668459</td></tr>
    <tr><td headers="AGED" class="gt_row gt_right">82</td>
<td headers="AGEREV" class="gt_row gt_right">81</td>
<td headers="ANAI" class="gt_row gt_right">1938</td>
<td headers="IPONDI" class="gt_row gt_right">3.478821</td></tr>
    <tr><td headers="AGED" class="gt_row gt_right">86</td>
<td headers="AGEREV" class="gt_row gt_right">85</td>
<td headers="ANAI" class="gt_row gt_right">1934</td>
<td headers="IPONDI" class="gt_row gt_right">3.478821</td></tr>
    <tr><td headers="AGED" class="gt_row gt_right">1</td>
<td headers="AGEREV" class="gt_row gt_right">0</td>
<td headers="ANAI" class="gt_row gt_right">2019</td>
<td headers="IPONDI" class="gt_row gt_right">2.776887</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Plus généralement, il est souvent d’usage d’utiliser la fonction <code>summary()</code> pour donner un aperçu de l’ensemble des variables, soit de leur distribution pour les variables quantitatives, soit de leur répartition par modalités pour les variables qualitatives ; la fonction permet également de nous donner l’information sur l’existence et le nombre de valeurs manquantes pour chaque variable.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="03-Manipulation-variables.html#cb24-1" tabindex="-1"></a><span class="fu">summary</span>(RP_final)</span></code></pre></div>
<pre><code>   CANTVILLE           ACHLR            AEMMR              AGED       
 75ZZ   : 853167   3      :687155   9      :2032861   Min.   :  0.00  
 9296   :  47490   4      :656626   8      : 286192   1st Qu.: 21.00  
 9398   :  43375   2      :314367   7      : 146463   Median : 36.00  
 9399   :  43104   1      :303570   6      :  91377   Mean   : 38.44  
 9499   :  37585   6      :301595   Z      :  34562   3rd Qu.: 55.00  
 9299   :  36678   5      :270547   5      :  30169   Max.   :120.00  
 (Other):1574634   (Other):102173   (Other):  14409                   
     AGER20           AGEREV         AGEREVQ             ANAI     
 54     :515753   Min.   :  0.0   25     : 226438   Min.   :1896  
 39     :412404   1st Qu.: 20.0   30     : 214781   1st Qu.:1963  
 64     :273384   Median : 36.0   35     : 197623   Median :1981  
 79     :263157   Mean   : 37.5   20     : 186496   Mean   :1980  
 29     :226438   3rd Qu.: 54.0   40     : 181466   3rd Qu.:1997  
 24     :186496   Max.   :119.0   0      : 177322   Max.   :2020  
 (Other):758401                   (Other):1451907                 
     ANEMR             APAF             ARM          ASCEN       BAIN       
 01     :655689   3      :777547   ZZZZZ  :1782866   1:1460332   X:  34562  
 03     :564056   0      :643516   75115  :  90717   2:1141139   Z:2601471  
 02     :542791   2      :620004   75118  :  78739   Z:  34562              
 00     :317238   1      :539040   75120  :  75863                          
 04     :256066   Z      : 34562   75119  :  73388                          
 05     :140210   6      :  8547   75113  :  70196                          
 (Other):159983   (Other): 12817   (Other): 464264                          
 BATI        CATIRIS     CATL        CATPC       CHAU        CHFL       
 X:  34562   A:  29884   1:2601471   0:2601471   X:  34562   1:1370090  
 Z:2601471   D:   1488   Z:  34562   1:  26328   Z:2601471   2: 654195  
             H:2597963               2:   8234               3: 563224  
             X:    988                                       4:  13962  
             Z:   5710                                       X:  34562  
                                                                        
                                                                        
 CHOS        CLIM        CMBL        COUPLE           CS1         CUIS       
 X:  34562   X:  34562   1: 583799   1:1091726   8      :903563   X:  34562  
 Z:2601471   Z:2601471   2:1060384   2:1544307   3      :457534   Z:2601471  
                         3: 117844               7      :374763              
                         4: 764429               5      :343737              
                         5:   7861               4      :323394              
                         6:  67154               6      :162434              
                         X:  34562               (Other): 70608              
 DEPT             DIPL             DNAI        EAU         EGOUL      
 75:853167   18     :486255   99     :716703   X:  34562   X:  34562  
 92:621663   ZZ     :465748   75     :538277   Z:2601471   Z:2601471  
 93:629049   17     :280471   92     :262709                          
 94:532154   13     :252762   93     :241894                          
             14     :252350   94     :185218                          
             16     :197267   78     : 37782                          
             (Other):701180   (Other):653450                          
 ELEC             EMPL         ETUD        GARL        HLML       
 X:  34562   ZZ     :1432384   1: 689558   1:1286127   1: 784089  
 Z:2601471   16     : 913146   2:1946475   2:1315344   2:1817382  
             15     : 104235               Z:  34562   Z:  34562  
             21     :  86275                                      
             22     :  48699                                      
             11     :  25485                                      
             (Other):  25809                                      
     ILETUD             ILT          IMMI        INAI       INATC      
 Z      :1946475   Z      :1432384   1: 614842   1:738724   1:2180430  
 1      : 484682   3      : 533246   2:2021191   2:614762   2: 455603  
 3      : 114507   1      : 449857               3:518740              
 2      :  76273   2      : 204924               4: 45574              
 4      :  13812   4      :  12853               5:  1530              
 5      :    167   7      :   2524               6:716703              
 (Other):    117   (Other):    245                                     
     IPONDI            IRAN                IRIS         LPRF      
 Min.   : 0.000   1      :2305666   920120303:   6961   0:643516  
 1st Qu.: 1.103   2      : 112053   ZZZZZZZZZ:   5710   1:654441  
 Median : 2.933   4      :  69107   930700109:   5523   2:517420  
 Mean   : 2.596   3      :  40599   751187110:   4104   3:762238  
 3rd Qu.: 3.404   Z      :  38020   920360501:   3818   4: 17410  
 Max.   :30.057   5      :  34401   751176714:   3807   5:  6446  
                  (Other):  36187   (Other)  :2606110   Z: 34562  
      LPRM         METRODOM         MOCO             MODV       
 1      :1209833   M:2636033   22     :585580   32     :585580  
 3      : 763890               11     :569579   11     :569579  
 2      : 513339               32     :526421   50     :321174  
 8      :  38136               21     :449260   40     :291436  
 Z      :  34562               12     :216515   12     :216515  
 6      :  32123               23     :137021   20     :205247  
 (Other):  44150               (Other):151657   (Other):446502  
      NA17         NA5              NAIDT              NBPI       
 ZZ     :1432384   AZ:    626   0      :1872226   03     :773582  
 OQ     : 316215   BE:  68660   30     : 716703   04     :628152  
 MN     : 223963   FZ:  50464   11     :  18616   02     :491816  
 GZ     : 129585   GU: 767684   12     :  16979   05     :284228  
 JZ     : 101100   OQ: 316215   14     :   5933   01     :263674  
 KZ     :  78928   ZZ:1432384   13     :   3526   06     : 97433  
 (Other): 353858                (Other):   2050   (Other): 97148  
     ORIDT         RECH        REGION       SANI        SANIDOM     
 0      :2570233   0: 595136   11:2636033   0:  17248   XX:  34562  
 11     :  26547   1:  99394                1: 148161   ZZ:2601471  
 12     :  23668   2:  81634                2:2436062               
 14     :   8155   9: 189296                X:  34562               
 13     :   4671   Z:1670573                                        
 18     :    908                                                    
 (Other):   1851                                                    
 SEXE        STAT_CONJ   STATR       STOCD            SURF        TACT        
 1:1263098   1: 806273   1:1067681   10:992691   4      :736488   11:1203649  
 2:1372935   2:  90782   2: 135968   21:627380   3      :583150   12: 179713  
             3: 229555   Z:1432384   22:757862   5      :440798   21: 382445  
             4: 101992               23:151152   1      :239343   22: 240715  
             5: 137488               30: 72386   2      :233363   23: 465748  
             6:1269943               ZZ: 34562   6      :189749   24:  64030  
                                                 (Other):213142   25:  99733  
    TACTD16        TP          TRANS           TRIRIS        TYPC       
 111    :1127202   1:1026823   1:  39223   ZZZZZZ :  47639   1: 259226  
 230    : 465748   2: 176826   2: 102898   931411 :  10563   2: 194433  
 210    : 382445   Z:1432384   3:  40772   920331 :   8408   3:2124270  
 220    : 240715               4:  44362   931071 :   8032   4:  22451  
 122    : 127564               5: 311836   940721 :   7834   5:   1091  
 250    :  99733               6: 664558   921011 :   7686   Z:  34562  
 (Other): 192626               Z:1432384   (Other):2545871              
 TYPL        WC         
 1: 330946   X:  34562  
 2:2220098   Z:2601471  
 3:  25394              
 4:  15607              
 5:   1942              
 6:   7484              
 Z:  34562              </code></pre>
<p>Mais attention, le problème ici est que cela nous donne des fréquences non pondérées pour l’ensemble de nos variables qualitatives, donc qui n’ont finalement pas grand sens.</p>
<div id="manipulation-des-variables-qualitatives" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Manipulation des variables qualitatives<a href="03-Manipulation-variables.html#manipulation-des-variables-qualitatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>On peut d’abord travailler sur les variables qualitatives qui correspondent ici à l’essentiel de nos variables.</p>
<p>Comme on le sait, on peut regarder les différents niveaux pour chacune d’entre elles, avec la fonction <code>levels()</code>. Si on veut appliquer la fonction à l’ensemble de nos variables facteurs sans avoir donc à les indiquer une par une, on peut avoir recours à la fonction <code>sapply()</code> qui permet d’appliquer la fonction indiquée entre parenthèses (ici <code>levels()</code>) à tous les éléments de notre table de données.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="03-Manipulation-variables.html#cb26-1" tabindex="-1"></a><span class="co"># Pour info, ici cela s&#39;écrirait : </span></span>
<span id="cb26-2"><a href="03-Manipulation-variables.html#cb26-2" tabindex="-1"></a>RP_final <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.factor)) <span class="sc">%&gt;%</span> <span class="fu">sapply</span>(levels)</span>
<span id="cb26-3"><a href="03-Manipulation-variables.html#cb26-3" tabindex="-1"></a><span class="co"># on peut même se passer de la sélection sur les variables :</span></span>
<span id="cb26-4"><a href="03-Manipulation-variables.html#cb26-4" tabindex="-1"></a><span class="co"># RP %&gt;% sapply(levels)</span></span></code></pre></div>
<p>On peut ensuite vouloir retravailler les modalités de ces variables, car par exemple les modalités ne sont pas parlantes puisque nommées par des codes chiffres, ou parce que les modalités sont trop nombreuses et qu’on souhaiterait les rassembler pour une analyse ultérieure.</p>
<p>Par exemple, si l’on veut étudier la répartition de la population francilienne selon leur statut d’activité, on peut utiliser la variable <code>TACT</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="03-Manipulation-variables.html#cb27-1" tabindex="-1"></a><span class="fu">levels</span>(RP_final<span class="sc">$</span>TACT)</span></code></pre></div>
<pre><code>[1] &quot;11&quot; &quot;12&quot; &quot;21&quot; &quot;22&quot; &quot;23&quot; &quot;24&quot; &quot;25&quot;</code></pre>
<p>Mais le moins qu’on puisse dire c’est que les 7 modalités de cette variable ne sont pas parlantes, on peut donc recoder les modalités de cette variable dans une étape préalable <em>DATA</em> comme ici ; on pourra bien sûr enchaîner plus tard les lignes de codes et réaliser cette étape dans une même procédure avec le tableau ou le graphique représentant cette variable.<br />
Commençons ici par l’étape <em>DATA</em> :</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="03-Manipulation-variables.html#cb29-1" tabindex="-1"></a><span class="co"># On cherche à quoi correspondent les modalités chiffrées de cette variable</span></span>
<span id="cb29-2"><a href="03-Manipulation-variables.html#cb29-2" tabindex="-1"></a><span class="co"># dans le fichier &quot;meta&quot;</span></span>
<span id="cb29-3"><a href="03-Manipulation-variables.html#cb29-3" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;TACT&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(COD_MOD, LIB_MOD)</span></code></pre></div>
<pre><code># A tibble: 7 × 2
  COD_MOD LIB_MOD                                                               
  &lt;fct&gt;   &lt;fct&gt;                                                                 
1 11      Actifs ayant un emploi, y compris sous apprentissage ou en stage rému…
2 12      Chômeurs                                                              
3 21      Retraités ou préretraités                                             
4 22      Élèves, étudiants, stagiaires non rémunéré de 14 ans ou plus          
5 23      Moins de 14 ans                                                       
6 24      Femmes ou hommes au foyer                                             
7 25      Autres inactifs                                                       </code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="03-Manipulation-variables.html#cb31-1" tabindex="-1"></a><span class="co"># On recode à partir de ces libellés, tout en regroupant certaines modalités</span></span>
<span id="cb31-2"><a href="03-Manipulation-variables.html#cb31-2" tabindex="-1"></a><span class="co"># qui sont très spécifiques et nous intéressent moins :</span></span>
<span id="cb31-3"><a href="03-Manipulation-variables.html#cb31-3" tabindex="-1"></a>RP_final <span class="ot">&lt;-</span> RP_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">TACT_moda =</span> <span class="fu">as.factor</span>(</span>
<span id="cb31-4"><a href="03-Manipulation-variables.html#cb31-4" tabindex="-1"></a>  <span class="fu">case_when</span>(TACT <span class="sc">==</span> <span class="st">&quot;11&quot;</span> <span class="sc">~</span> <span class="st">&quot;Actifs en emploi&quot;</span>,</span>
<span id="cb31-5"><a href="03-Manipulation-variables.html#cb31-5" tabindex="-1"></a>            TACT <span class="sc">==</span> <span class="st">&quot;12&quot;</span> <span class="sc">~</span> <span class="st">&quot;Chômeurs&quot;</span>,</span>
<span id="cb31-6"><a href="03-Manipulation-variables.html#cb31-6" tabindex="-1"></a>            TACT <span class="sc">==</span> <span class="st">&quot;21&quot;</span> <span class="sc">~</span> <span class="st">&quot;Retraités&quot;</span>,</span>
<span id="cb31-7"><a href="03-Manipulation-variables.html#cb31-7" tabindex="-1"></a>            TACT <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;22&quot;</span>,<span class="st">&quot;23&quot;</span>,<span class="st">&quot;24&quot;</span>,<span class="st">&quot;25&quot;</span>) <span class="sc">~</span> <span class="st">&quot;Autres inactifs&quot;</span>)))</span>
<span id="cb31-8"><a href="03-Manipulation-variables.html#cb31-8" tabindex="-1"></a><span class="fu">levels</span>(RP_final<span class="sc">$</span>TACT_moda)</span></code></pre></div>
<pre><code>[1] &quot;Actifs en emploi&quot; &quot;Autres inactifs&quot;  &quot;Chômeurs&quot;         &quot;Retraités&quot;       </code></pre>
<p>Si l’on veut changer l’ordre des modalités, qui s’afficheront comme ci-dessus dans un tableau ou un graphique, on peut utiliser la fonction <code>fct_relevel()</code> du package <strong><code>forcats</code></strong> (à installer avant puis à appeler avant de l’utiliser) :</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="03-Manipulation-variables.html#cb33-1" tabindex="-1"></a><span class="co"># install.package(&quot;forcats&quot;)</span></span>
<span id="cb33-2"><a href="03-Manipulation-variables.html#cb33-2" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb33-3"><a href="03-Manipulation-variables.html#cb33-3" tabindex="-1"></a>RP_final <span class="ot">&lt;-</span> RP_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">TACT_moda =</span> </span>
<span id="cb33-4"><a href="03-Manipulation-variables.html#cb33-4" tabindex="-1"></a>                                  <span class="fu">fct_relevel</span>(TACT_moda, </span>
<span id="cb33-5"><a href="03-Manipulation-variables.html#cb33-5" tabindex="-1"></a>                                              <span class="fu">c</span>(<span class="st">&quot;Actifs en emploi&quot;</span>,<span class="st">&quot;Chômeurs&quot;</span>,</span>
<span id="cb33-6"><a href="03-Manipulation-variables.html#cb33-6" tabindex="-1"></a>                                                <span class="st">&quot;Retraités&quot;</span>, <span class="st">&quot;Autres inactifs&quot;</span>)))</span>
<span id="cb33-7"><a href="03-Manipulation-variables.html#cb33-7" tabindex="-1"></a><span class="fu">levels</span>(RP_final<span class="sc">$</span>TACT_moda)</span></code></pre></div>
<pre><code>[1] &quot;Actifs en emploi&quot; &quot;Chômeurs&quot;         &quot;Retraités&quot;        &quot;Autres inactifs&quot; </code></pre>
<p>Plus largement, pour travailler sur des variables qualitatives en particulier lorsqu’elles sont en format facteur, le package <strong><code>forcats</code></strong> est très utile. Outre une fonction de transformation d’une variable caractère en facteur (<code>as_factor()</code> proche de la version de baseR <code>as.factor()</code> utilisée en début de section), elle contient plein d’autres fonctions : <code>fct_collapse()</code> utilisée pour renommer ou regrouper des modalités d’une variable (au lieu de la double fonction <code>as.factor()</code> et <code>case_when()</code>) ; <code>fct_relevel()</code> utilisée également au-dessus pour trier les modalités comme on le souhaite ; <code>fct_drop()</code> pour enlever des niveaux de facteurs vides/sans effectifs ; <code>fct_explicit_na()</code> pour rendre les NA explicites en créant une modalité “(missing)” ; <code>fct_reorder()</code> et <code>fct_reorder2()</code> pour réordonner les modalités d’une variable, très utile pour les graphiques car utilisables directement dans <code>ggplot()</code> ; <code>fct_lump()</code> pour regrouper les modalités les plus communes (ou au contraire les moins communes) en lui indiquant entre parenthèses le nombre <code>n=</code> de modalités souhaitées ou la proportion minimum souhaitée <code>prop=</code>, et en sélectionnant la variable avec la fonction <code>pull()</code> avant car elle doit être en format vecteur et non data.frame ; ou encore <code>fct_recode()</code> pour changer le niveau des facteurs ; <code>fct_other()</code> ; <code>fct_infreq()</code> et <code>fct_inorder()</code> ; etc. Un bon récapitulatif de ces fonctions est présenté <a href="https://thinkr.fr/forcats-forcats-vous-avez-dit-forcats/" target="_blank">ici</a>.</p>
</div>
<div id="manipulation-des-variables-quantitatives" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Manipulation des variables quantitatives<a href="03-Manipulation-variables.html#manipulation-des-variables-quantitatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comme nous l’avons vu plus haut, il y a peu de variables quantitatives dans cette base et l’une d’entre elles est la pondération, donc on va regarder plus précisément la variable <code>AGED</code>. Cependant, celle-ci aussi est particulière car c’est une variable numérique constituée d’entiers naturels (et non de valeurs réelles) qui vont de 0 à 120 ; dans le fichier des métadonnées (ou le dictionnaire des variables disponible également sur le site de l’Insee), on se rend compte que la variable a été pensée comme catégorielle avec des modalités d’abord codées comme “000”, “001”, etc.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="03-Manipulation-variables.html#cb35-1" tabindex="-1"></a>meta <span class="sc">%&gt;%</span> <span class="fu">filter</span>(COD_VAR<span class="sc">==</span><span class="st">&quot;AGED&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(COD_MOD, LIB_MOD) <span class="sc">%&gt;%</span> <span class="fu">tail</span>()</span></code></pre></div>
<pre><code># A tibble: 6 × 2
  COD_MOD LIB_MOD
  &lt;fct&gt;   &lt;fct&gt;  
1 115     115 ans
2 116     116 ans
3 117     117 ans
4 118     118 ans
5 119     119 ans
6 120     120 ans</code></pre>
<p>On peut alors regarder rapidement la distribution de cette variable.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="03-Manipulation-variables.html#cb37-1" tabindex="-1"></a><span class="fu">summary</span>(RP_final<span class="sc">$</span>AGED)</span></code></pre></div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00   21.00   36.00   38.44   55.00  120.00 </code></pre>
<p>On peut aussi construire des variables continues en agrégeant certaines informations au niveau des communes par exemple. Reprenons la variable d’activité dont nous avons recoder et regrouper les modalités et calculons-là pour avoir le nombre de chaque modalité par commune. Il faut pour cela créer la variable de commune, qu’on appelera <code>COM</code>, à partir de l’IRIS :</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="03-Manipulation-variables.html#cb39-1" tabindex="-1"></a>RP_final <span class="ot">&lt;-</span> RP_final <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">COM=</span><span class="fu">substr</span>(IRIS, <span class="dv">1</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>On va ensuite sommer chaque modalité de la variable <code>TACT_moda</code> en utilisant la pondération en groupant par commune.</p>
<p><strong>EXERCICE</strong> :<br />
Créer donc un tableau qui aura 3 colonnes <code>COM</code>, <code>TACT_moda</code> et <code>n</code>. Vous pouvez utiliser les fonctions <code>group_by</code> suivi soit de <code>count</code>, soit de <code>summarise</code> ; on cherchera finalement à arrondir ces valeurs à l’unité avec la fonction <code>round()</code>. Vous devez obtenir le tableau suivant :</p>
<div class="solution-exo">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="03-Manipulation-variables.html#cb40-1" tabindex="-1"></a>Tab_com_TACT <span class="ot">&lt;-</span> RP_final <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(COM) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="03-Manipulation-variables.html#cb40-2" tabindex="-1"></a>  <span class="fu">count</span>(TACT_moda, <span class="at">wt=</span>IPONDI) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="03-Manipulation-variables.html#cb40-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n=</span><span class="fu">round</span>(n))</span>
<span id="cb40-4"><a href="03-Manipulation-variables.html#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="03-Manipulation-variables.html#cb40-5" tabindex="-1"></a><span class="co"># RP_final %&gt;% group_by(COM, TACT_moda) %&gt;% </span></span>
<span id="cb40-6"><a href="03-Manipulation-variables.html#cb40-6" tabindex="-1"></a><span class="co">#   summarise(n=sum(IPONDI)) %&gt;% </span></span>
<span id="cb40-7"><a href="03-Manipulation-variables.html#cb40-7" tabindex="-1"></a><span class="co">#   mutate(n=round(n))</span></span></code></pre></div>
</div>
<p>On voit qu’on a un tableau dans un format “long” puisqu’il y a plusieurs observations pour une seule commune. On va utiliser la fonction <code>pivot_wider()</code> mentionnée précédemment pour n’avoir qu’une ligne par commune et en colonne les types de statut avec leur nombre respectif.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="03-Manipulation-variables.html#cb41-1" tabindex="-1"></a>Tab_com_TACT <span class="ot">&lt;-</span> Tab_com_TACT <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="03-Manipulation-variables.html#cb41-2" tabindex="-1"></a>                   <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> TACT_moda, <span class="at">values_from =</span> n)</span>
<span id="cb41-3"><a href="03-Manipulation-variables.html#cb41-3" tabindex="-1"></a>Tab_com_TACT</span></code></pre></div>
<pre><code># A tibble: 137 × 5
   COM   `Actifs en emploi` Chômeurs Retraités `Autres inactifs`
   &lt;chr&gt;              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;
 1 75101               8366      941      2630              3979
 2 75102              13118     1378      2148              4964
 3 75103              19239     2085      4589              8123
 4 75104              15227     1863      4508              7513
 5 75105              27378     2611     10607             17618
 6 75106              18073     1842      8180             12176
 7 75107              23394     2165      9573             13735
 8 75108              18254     1565      5297             10534
 9 75109              34155     3482      7264             15125
10 75110              46454     6343     10645             23078
# ℹ 127 more rows</code></pre>

</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>






<script src="js/tidyverse.js"></script>
            </section>

          </div>
        </div>
      </div>
<a href="02-Manipulation-base.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"],
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Camille-Sisi/Data-Mining-2025/master/03-Manipulation-variables.Rmd",
"text": "Source"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
