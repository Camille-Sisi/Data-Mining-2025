{
  "hash": "7aaf869cdb8cb81a28d625bd3a1686b9",
  "result": {
    "engine": "knitr",
    "markdown": "# Modèles de régression : application sur les offres de Pôle emploi 2020 {#sec-Modeles-regression}\n\nOn cherche maintenant à expliquer un phénomène ou une variable par rapport à d'autres. On va ici s'intéresser au fait qu'une offre de Pôle emploi corresponde à un CDI ou non.\\\nOn va repartir de la base `OffresPE_2020` en réduisant le champ pour améliorer les temps de calcul, par exemple en ne s'intéressant qu'à Paris, puis en retravaillant un peu les variables avant de lancer les modèles de régression.\n\n## La création des bases d'apprentissage et de test\n\nOn crée notre base de travail en ne prenant que les variables qui nous intéressent, dont certaines retravaillées avant (création de variables catégorielles plus pertinentes dans une régression logistique). La fonction `relevel()` permet d'indiquer la modalité de référence que l'on veut dans les régressions futures, ici pour la régression logistique.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fancycut)\nlibrary(janitor)\nlibrary(tidyverse)\n\nOffresPE_2020 <- readRDS(\"data/OffresPE_2020.Rdata\") \n\nOffresPE_2020$salary_cat <- fancycut(OffresPE_2020$salary_hourly_mean,\n                                    \"Entre 0 et moins que le SMIC (10€)\" = \"(0, 10]\",\n                                    \"Entre le SMIC et le Q1(11,6€)\" = \"(10, 11.6]\", \n                                    \"Entre le Q1 et la moyenne (20,1€)\" = \"(11.6, 20.1]\",\n                                    \"Entre la moyenne et le D9 observée en France(15€)\" = \"(20.1, 28]\",\n                                    \"Entre le D9 et le maximum (40200€)\" = \"(28, 40200)\",\n                                    na.bucket = \"Manquant\")\nOffresPE_2020 %>%  tabyl(salary_cat) %>% adorn_pct_formatting()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                        salary_cat      n percent\n                Entre 0 et moins que le SMIC (10€)   3489    0.8%\n                     Entre le SMIC et le Q1(11,6€)  21857    5.2%\n                 Entre le Q1 et la moyenne (20,1€)  46964   11.2%\n Entre la moyenne et le D9 observée en France(15€)  17356    4.1%\n                Entre le D9 et le maximum (40200€)  10933    2.6%\n                                          Manquant 319923   76.1%\n                                              <NA>      1    0.0%\n```\n\n\n:::\n\n```{.r .cell-code}\nOffresPE_reg <- OffresPE_2020 %>% \n  filter(location_departement==\"75\") %>% \n  mutate(mois_publication=months(date_sitePublicationDay, abbreviate = T),\n         mois_publication= factor(mois_publication,\n                                  levels = c(\"janv.\", \"févr.\", \"mars\", \"avr.\", \"mai\", \"juin\", \"juil.\", \n                                             \"août\", \"sept.\", \"oct.\", \"nov.\", \"déc.\")),\n         secteurs=as.factor(case_when(entrepriseSecteur_NAF21 %in% c(\"C\", \"D\", \"E\") ~ \"Industrie\",\n                                      entrepriseSecteur_NAF21 ==\"F\" ~ \"Construction\",\n                                      entrepriseSecteur_NAF21 ==\"G\" ~ \"Commerce\",\n                                      entrepriseSecteur_NAF21 ==\"H\" ~ \"Transports\",\n                                      entrepriseSecteur_NAF21 ==\"I\" ~ \"Hébergement/restauration\",\n                                      entrepriseSecteur_NAF21 ==\"J\" ~ \"Info/com\",\n                                      entrepriseSecteur_NAF21 %in% c(\"K\", \"L\") ~ \"Activités fi et immo\",\n                                      entrepriseSecteur_NAF21 ==\"M\" ~ \"Activités spé, scientifiques et techniques\",\n                                      entrepriseSecteur_NAF21 ==\"N\" ~ \"Activités services administratifs et soutien\",\n                                      entrepriseSecteur_NAF21 ==\"O\" ~ \"Administration publique\",\n                                      entrepriseSecteur_NAF21 ==\"P\" ~ \"Enseignement\",\n                                      entrepriseSecteur_NAF21 ==\"Q\" ~ \"Santé humaine et action sociale\",\n                                      entrepriseSecteur_NAF21 ==\"R\" ~ \"Arts, spectacles et activités récréatives\",\n                                      entrepriseSecteur_NAF21 ==\"S\" ~ \"Autres activités de service\",\n                                      entrepriseSecteur_NAF21 ==\"T\" ~ \"Activités des ménages en tant qu'employeurs\",\n                                      TRUE ~ \"Manquant ou U\")),\n         CDI = as.factor(case_when(contractType == \"CDI\" ~  \"Oui\",\n                                 TRUE ~ \"Non\")),\n         salary_cat=relevel(salary_cat, ref=\"Entre le D9 et le maximum (40200€)\"),\n         secteurs=relevel(secteurs, ref=\"Construction\")) %>% \n  select(mois_publication, salary_cat, CDI, secteurs)\n```\n:::\n\n\nDe manière traditionnelle, dans les modèles de prédiction ou *machine learning*, on n'applique pas le modèle sur l'ensemble de la base de données mais d'abord sur un échantillon dit d'apprentissage puis on le \"teste\" sur l'échantillon restant. On va donc ici suivre ce schéma et diviser notre base de données en deux pour avoir un échantillon d'apprentissage ou d'entraînement, et un autre test.\\\n\\\nOn utilise pour cela la fonction `sample` (mais d'autres fonctions existent) en lui spécifiant la façon de diviser la base avec l'argument `prob=` : ici on choisit de diviser notre base selon un rapport 70% *vs* 30%, autrement dit notre base d'apprentissage comprendra 70% des données de la base initiale, alors que la base de test comprendra les 30% restants. On pourrait procéder à un rapport du type 80% *vs* 20%, ou 75% *vs* 25%, etc.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# On choisit la façon de diviser notre base et on l'applique en créant 2 bases\nsample <- sample(c(TRUE, FALSE), nrow(OffresPE_reg), replace=TRUE, prob=c(0.70,0.3))\nOffresPE_train <- OffresPE_reg[sample, ]\nOffresPE_test  <- OffresPE_reg[!sample, ]\n\n# On regarde quelle est la taille de nos deux bases\ndim(OffresPE_train)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 123008      4\n```\n\n\n:::\n\n```{.r .cell-code}\ndim(OffresPE_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 52769     4\n```\n\n\n:::\n\n```{.r .cell-code}\n# On vérifie que les proportions de notre variable d'intérêt sont assez proches\n# entre les deux bases\nlibrary(gt)\nOffresPE_train %>% tabyl(CDI) %>% adorn_pct_formatting() %>% \n  adorn_totals(\"row\") %>% gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"trrwbagxph\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#trrwbagxph table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#trrwbagxph thead, #trrwbagxph tbody, #trrwbagxph tfoot, #trrwbagxph tr, #trrwbagxph td, #trrwbagxph th {\n  border-style: none;\n}\n\n#trrwbagxph p {\n  margin: 0;\n  padding: 0;\n}\n\n#trrwbagxph .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#trrwbagxph .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#trrwbagxph .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#trrwbagxph .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#trrwbagxph .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#trrwbagxph .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#trrwbagxph .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#trrwbagxph .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#trrwbagxph .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#trrwbagxph .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#trrwbagxph .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#trrwbagxph .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#trrwbagxph .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#trrwbagxph .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#trrwbagxph .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#trrwbagxph .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#trrwbagxph .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#trrwbagxph .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#trrwbagxph .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#trrwbagxph .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#trrwbagxph .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#trrwbagxph .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#trrwbagxph .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#trrwbagxph .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#trrwbagxph .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#trrwbagxph .gt_left {\n  text-align: left;\n}\n\n#trrwbagxph .gt_center {\n  text-align: center;\n}\n\n#trrwbagxph .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#trrwbagxph .gt_font_normal {\n  font-weight: normal;\n}\n\n#trrwbagxph .gt_font_bold {\n  font-weight: bold;\n}\n\n#trrwbagxph .gt_font_italic {\n  font-style: italic;\n}\n\n#trrwbagxph .gt_super {\n  font-size: 65%;\n}\n\n#trrwbagxph .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#trrwbagxph .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#trrwbagxph .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#trrwbagxph .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#trrwbagxph .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#trrwbagxph .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#trrwbagxph .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#trrwbagxph .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#trrwbagxph div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CDI\">CDI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"percent\">percent</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Non</td>\n<td headers=\"n\" class=\"gt_row gt_right\">26908</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">21.9%</td></tr>\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Oui</td>\n<td headers=\"n\" class=\"gt_row gt_right\">96100</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">78.1%</td></tr>\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Total</td>\n<td headers=\"n\" class=\"gt_row gt_right\">123008</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">-</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nOffresPE_test %>% tabyl(CDI) %>% adorn_pct_formatting() %>% \n  adorn_totals(\"row\") %>% gt()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"umkgdkfanx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#umkgdkfanx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#umkgdkfanx thead, #umkgdkfanx tbody, #umkgdkfanx tfoot, #umkgdkfanx tr, #umkgdkfanx td, #umkgdkfanx th {\n  border-style: none;\n}\n\n#umkgdkfanx p {\n  margin: 0;\n  padding: 0;\n}\n\n#umkgdkfanx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#umkgdkfanx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#umkgdkfanx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#umkgdkfanx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#umkgdkfanx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#umkgdkfanx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#umkgdkfanx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#umkgdkfanx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#umkgdkfanx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#umkgdkfanx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#umkgdkfanx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#umkgdkfanx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#umkgdkfanx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#umkgdkfanx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#umkgdkfanx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#umkgdkfanx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#umkgdkfanx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#umkgdkfanx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#umkgdkfanx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#umkgdkfanx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#umkgdkfanx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#umkgdkfanx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#umkgdkfanx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#umkgdkfanx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#umkgdkfanx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#umkgdkfanx .gt_left {\n  text-align: left;\n}\n\n#umkgdkfanx .gt_center {\n  text-align: center;\n}\n\n#umkgdkfanx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#umkgdkfanx .gt_font_normal {\n  font-weight: normal;\n}\n\n#umkgdkfanx .gt_font_bold {\n  font-weight: bold;\n}\n\n#umkgdkfanx .gt_font_italic {\n  font-style: italic;\n}\n\n#umkgdkfanx .gt_super {\n  font-size: 65%;\n}\n\n#umkgdkfanx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#umkgdkfanx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#umkgdkfanx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#umkgdkfanx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#umkgdkfanx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#umkgdkfanx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#umkgdkfanx .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#umkgdkfanx .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#umkgdkfanx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CDI\">CDI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"n\">n</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"percent\">percent</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Non</td>\n<td headers=\"n\" class=\"gt_row gt_right\">11670</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">22.1%</td></tr>\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Oui</td>\n<td headers=\"n\" class=\"gt_row gt_right\">41099</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">77.9%</td></tr>\n    <tr><td headers=\"CDI\" class=\"gt_row gt_center\">Total</td>\n<td headers=\"n\" class=\"gt_row gt_right\">52769</td>\n<td headers=\"percent\" class=\"gt_row gt_right\">-</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nLes deux bases présentent une répartition CDI/pas CDI très proche : dans le 75, environ 78% des offres d'emploi émises sur le site de Pôle emploi sont en CDI.\n\n## Un modèle à visée principale explicative : la régression logistique\n\nLa fonction `glm` du package **`stats`** (à installer avant appel dans la librarie) est principalement utilisée pour modéliser différents types de régression : l'argument `family=binomial(\"logit\")` permet d'utiliser un modèle logit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"stats\")\nlibrary(stats)\n```\n:::\n\n\n### Le modèle initial\n\nOn crée le modèle en spécifiant la variable d'intérêt puis les variables explicatives ou l'ensemble des variables présentes dans la base si nous avons déjà procédé à une sélection des variables : c'est le cas ici donc c'est pour cela que l'on indique juste un \".\" après le \"\\~\", sinon on devrait écrire les variables une par une, ou les sctoker dans une liste et appeler la liste.\n\nMême si ce type modèle doit permettre essentiellement d'expliquer un phénomène, ici qu'une offre d'emploi soit en CDI ou non, on peut l'utiliser aussi pour prédire les données. C'est pourquoi nous appliquons d'abord le logit sur la base (réduite) d'apprentissage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogit_1 <- glm (CDI ~ ., \n                data=OffresPE_train, \n                family = binomial(\"logit\"))\nsummary(logit_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = CDI ~ ., family = binomial(\"logit\"), data = OffresPE_train)\n\nCoefficients:\n                                                             Estimate\n(Intercept)                                                  3.317992\nmois_publicationfévr.                                       -0.254771\nmois_publicationmars                                        -0.065913\nmois_publicationavr.                                        -0.114595\nmois_publicationmai                                         -0.413980\nmois_publicationjuin                                        -0.602573\nmois_publicationjuil.                                       -0.488606\nmois_publicationaoût                                        -0.235788\nmois_publicationsept.                                       -0.022989\nmois_publicationoct.                                         0.045417\nmois_publicationnov.                                         0.184077\nmois_publicationdéc.                                        -0.077525\nsalary_catEntre 0 et moins que le SMIC (10€)                -2.994267\nsalary_catEntre le SMIC et le Q1(11,6€)                     -1.988778\nsalary_catEntre le Q1 et la moyenne (20,1€)                 -1.508541\nsalary_catEntre la moyenne et le D9 observée en France(15€) -0.550997\nsalary_catManquant                                          -2.029324\nsecteursActivités des ménages en tant qu'employeurs         -5.551243\nsecteursActivités fi et immo                                -0.002512\nsecteursActivités services administratifs et soutien        -1.965045\nsecteursActivités spé, scientifiques et techniques          -0.024905\nsecteursAdministration publique                             -2.479553\nsecteursArts, spectacles et activités récréatives           -1.560948\nsecteursAutres activités de service                         -0.796736\nsecteursCommerce                                            -0.079622\nsecteursEnseignement                                        -2.687911\nsecteursHébergement/restauration                             0.185856\nsecteursIndustrie                                            0.081683\nsecteursInfo/com                                             0.930045\nsecteursManquant ou U                                        0.706231\nsecteursSanté humaine et action sociale                     -0.794446\nsecteursTransports                                          -0.493648\n                                                            Std. Error z value\n(Intercept)                                                   0.139288  23.821\nmois_publicationfévr.                                         0.033535  -7.597\nmois_publicationmars                                          0.036128  -1.824\nmois_publicationavr.                                          0.041648  -2.752\nmois_publicationmai                                           0.040193 -10.300\nmois_publicationjuin                                          0.034820 -17.306\nmois_publicationjuil.                                         0.034229 -14.275\nmois_publicationaoût                                          0.036087  -6.534\nmois_publicationsept.                                         0.035202  -0.653\nmois_publicationoct.                                          0.035400   1.283\nmois_publicationnov.                                          0.043153   4.266\nmois_publicationdéc.                                          0.043472  -1.783\nsalary_catEntre 0 et moins que le SMIC (10€)                  0.102690 -29.158\nsalary_catEntre le SMIC et le Q1(11,6€)                       0.076990 -25.832\nsalary_catEntre le Q1 et la moyenne (20,1€)                   0.071038 -21.236\nsalary_catEntre la moyenne et le D9 observée en France(15€)   0.078285  -7.038\nsalary_catManquant                                            0.069952 -29.010\nsecteursActivités des ménages en tant qu'employeurs           0.203613 -27.264\nsecteursActivités fi et immo                                  0.137649  -0.018\nsecteursActivités services administratifs et soutien          0.121852 -16.126\nsecteursActivités spé, scientifiques et techniques            0.126331  -0.197\nsecteursAdministration publique                               0.151153 -16.404\nsecteursArts, spectacles et activités récréatives             0.187551  -8.323\nsecteursAutres activités de service                           0.132460  -6.015\nsecteursCommerce                                              0.134598  -0.592\nsecteursEnseignement                                          0.133279 -20.167\nsecteursHébergement/restauration                              0.143864   1.292\nsecteursIndustrie                                             0.149576   0.546\nsecteursInfo/com                                              0.142408   6.531\nsecteursManquant ou U                                         0.122276   5.776\nsecteursSanté humaine et action sociale                       0.125624  -6.324\nsecteursTransports                                            0.192541  -2.564\n                                                            Pr(>|z|)    \n(Intercept)                                                  < 2e-16 ***\nmois_publicationfévr.                                       3.02e-14 ***\nmois_publicationmars                                         0.06809 .  \nmois_publicationavr.                                         0.00593 ** \nmois_publicationmai                                          < 2e-16 ***\nmois_publicationjuin                                         < 2e-16 ***\nmois_publicationjuil.                                        < 2e-16 ***\nmois_publicationaoût                                        6.41e-11 ***\nmois_publicationsept.                                        0.51372    \nmois_publicationoct.                                         0.19949    \nmois_publicationnov.                                        1.99e-05 ***\nmois_publicationdéc.                                         0.07453 .  \nsalary_catEntre 0 et moins que le SMIC (10€)                 < 2e-16 ***\nsalary_catEntre le SMIC et le Q1(11,6€)                      < 2e-16 ***\nsalary_catEntre le Q1 et la moyenne (20,1€)                  < 2e-16 ***\nsalary_catEntre la moyenne et le D9 observée en France(15€) 1.95e-12 ***\nsalary_catManquant                                           < 2e-16 ***\nsecteursActivités des ménages en tant qu'employeurs          < 2e-16 ***\nsecteursActivités fi et immo                                 0.98544    \nsecteursActivités services administratifs et soutien         < 2e-16 ***\nsecteursActivités spé, scientifiques et techniques           0.84372    \nsecteursAdministration publique                              < 2e-16 ***\nsecteursArts, spectacles et activités récréatives            < 2e-16 ***\nsecteursAutres activités de service                         1.80e-09 ***\nsecteursCommerce                                             0.55415    \nsecteursEnseignement                                         < 2e-16 ***\nsecteursHébergement/restauration                             0.19640    \nsecteursIndustrie                                            0.58500    \nsecteursInfo/com                                            6.54e-11 ***\nsecteursManquant ou U                                       7.66e-09 ***\nsecteursSanté humaine et action sociale                     2.55e-10 ***\nsecteursTransports                                           0.01035 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 129237  on 123007  degrees of freedom\nResidual deviance: 103084  on 122976  degrees of freedom\nAIC: 103148\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n:::\n\n\nCertaines modalités des variables ne sont pas significatives (voir les étoiles), mais la grande majorité le sont.\n\n<!--On peut ensuite évaluer la significativité globale du modèle, : -->\n\n\n\nOn va donc l'appliquer maintenant à la base test, en créant des indicateurs mesurant le taux de prédiction ou au contraire d'erreur.\n\nLe modèle `predict` permet d'abord d'abord de calculer la probabilité qu'une offre d'emploi soit en CDI pour chaque offre, l'argument `type=\"response\"` permettant d'appliquer le modèle logistique. Il est plus intéressant d'avoir la probabilité d'une variable de type qualitative, \"oui\"/\"non\" comme la variable d'intérêt du modèle, il faut donc procéder à une transformation aboutissant à une nouvelle variable (on considère alors que si la probabilité est strictement supérieure à 0.50 alors cela équivaut à une modalité \"oui\"). Enfin, on crée une matrice de confusion qui est en réalité un tableau croisé entre les valeurs observées et les prédicitions du modèle ; et on calcule un taux d'erreur en rapportant la somme des éléments hors diagonale principale à la somme des observations totales (de la matrice donc).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modèle de prédiction pour récupérer les probabilités individuelles d'être en couple\npred.proba <- predict(logit_1, newdata = OffresPE_test, type=\"response\")\n\n# On transforme les probas en variable qualitative\npred.moda <- factor(case_when(pred.proba>0.5 ~ \"oui\", TRUE ~ \"non\"))\n\n# On crée la matrice de confusion\nmatrice_conf <- table(OffresPE_test$CDI, pred.moda)\nmatrice_conf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     pred.moda\n        non   oui\n  Non  4518  7152\n  Oui  1497 39602\n```\n\n\n:::\n\n```{.r .cell-code}\n# On calcule le taux d'erreur\ntx_erreur <- (matrice_conf[2,1]+matrice_conf[1,2])/sum(matrice_conf)\ntx_erreur * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16.3903\n```\n\n\n:::\n:::\n\n\nOn voit que parmi la modalité observée \"Oui\" de la base de données, le modèle prédit environ 39 000 oui soit 96% de cette modalité, c'est la grande majorité ; la prédiction est moins bonne si on regarde la modalité \"Non\", puisque environ 4 500 observations, soit 39% de cette modalité, se retrouvent bien en \"non\". Le taux d'erreur de 16,3% montre bien néanmoins que le modèle prédit plutôt bien.\\\n\\\n\nUne autre façon de faire est d'ajouter, après les deux premières étapes réécrites ici, la variable de prédiction à la table initiale et de créer une nouvelle variable qui indique si on a bien une correspondance entre les modalités des deux variables : l'initiale et celle prédite. Cela nous donne donc le taux d'erreur calculé au-dessus, on retrouve bien 16,3% de correspondances inexactes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modèle de prédiction pour récupérer les probabilités individuelles d'être en couple\n#pred.proba <- predict(logit_1, newdata = OffresPE_test, type=\"response\")\n\n# On transforme les probas en variable qualitative\n#pred.moda <- factor(case_when(pred.proba>0.5 ~ \"oui\", TRUE ~ \"non\"))\n\n# On ajoute la variable de prédiction dans la table test initiale\nOffresPE_test_bis <- cbind.data.frame(OffresPE_test, var_predict=pred.moda)\n# et on créer une variable indiquant ou non la correspondance entre\n# les modalités des deux variables\nOffresPE_test_bis %>% \n  mutate(predict_OK=as.factor(case_when(CDI==\"Oui\" & var_predict==\"oui\" ~ \"oui\", \n                                        CDI==\"Non\" & var_predict==\"non\" ~ \"oui\",\n                                        TRUE ~ \"non\"))) %>% \n  tabyl(predict_OK) %>% adorn_pct_formatting() %>% adorn_totals(\"row\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n predict_OK     n percent\n        non  8649   16.4%\n        oui 44120   83.6%\n      Total 52769       -\n```\n\n\n:::\n\n```{.r .cell-code}\n# On supprime la table créée en test\nrm(OffresPE_test_bis)\n```\n:::\n\n\n### L'évaluation du modèle et la recherche éventuelle d'un \"meilleur\" modèle\n\nOn peut améliorer le modèle en recherchant celui qui est le \"meilleur\" en faisant une sélection sur les variables, plus précisément en demandant au modèle de choisir les variables les plus explicatives, car peut-être que certaines ne sont pas nécessaires à l'explication du modèle (dans notre cas, nous avons néanmoins vu que toutes les variables étaient significatives donc a priori utiles dans le modèle).\n\nPour une sélection \"pas à pas\", il faut utiliser le package **`MASS`** et la fonction `stepAIC` car c'est à travers le critère AIC (\"Akaike Information Criterion\",) que le modèle va chercher à être \"meilleur\" : plus il sera faible, meilleur il sera. On va d'abord faire cette sélection de façon \"descendante\" c'est-à-dire en partant du modèle initial \"logit_1\" ici : on part du modèle avec l'ensemble des variables et on en supprime une au fur et à mesure pour voir si le modèle est \"meilleur\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"MASS)\nlibrary(MASS)\nlogit_backward <- stepAIC(logit_1, \n                          scope=list(lower=\"CDI ~ 1\", \n                          upper=\"CDI ~ mois_publication + secteurs + salary_cat\"),\n                          direction=\"backward\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=103147.8\nCDI ~ mois_publication + salary_cat + secteurs\n\n                   Df Deviance    AIC\n<none>                  103084 103148\n- mois_publication 11   103875 103917\n- salary_cat        5   105500 105554\n- secteurs         15   125478 125512\n```\n\n\n:::\n\n```{.r .cell-code}\nlogit_backward\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:  glm(formula = CDI ~ mois_publication + salary_cat + secteurs, \n    family = binomial(\"logit\"), data = OffresPE_train)\n\nCoefficients:\n                                                (Intercept)  \n                                                   3.317992  \n                                      mois_publicationfévr.  \n                                                  -0.254771  \n                                       mois_publicationmars  \n                                                  -0.065913  \n                                       mois_publicationavr.  \n                                                  -0.114595  \n                                        mois_publicationmai  \n                                                  -0.413980  \n                                       mois_publicationjuin  \n                                                  -0.602573  \n                                      mois_publicationjuil.  \n                                                  -0.488606  \n                                       mois_publicationaoût  \n                                                  -0.235788  \n                                      mois_publicationsept.  \n                                                  -0.022989  \n                                       mois_publicationoct.  \n                                                   0.045417  \n                                       mois_publicationnov.  \n                                                   0.184077  \n                                       mois_publicationdéc.  \n                                                  -0.077525  \n               salary_catEntre 0 et moins que le SMIC (10€)  \n                                                  -2.994267  \n                    salary_catEntre le SMIC et le Q1(11,6€)  \n                                                  -1.988778  \n                salary_catEntre le Q1 et la moyenne (20,1€)  \n                                                  -1.508541  \nsalary_catEntre la moyenne et le D9 observée en France(15€)  \n                                                  -0.550997  \n                                         salary_catManquant  \n                                                  -2.029324  \n        secteursActivités des ménages en tant qu'employeurs  \n                                                  -5.551243  \n                               secteursActivités fi et immo  \n                                                  -0.002512  \n       secteursActivités services administratifs et soutien  \n                                                  -1.965045  \n         secteursActivités spé, scientifiques et techniques  \n                                                  -0.024905  \n                            secteursAdministration publique  \n                                                  -2.479553  \n          secteursArts, spectacles et activités récréatives  \n                                                  -1.560948  \n                        secteursAutres activités de service  \n                                                  -0.796736  \n                                           secteursCommerce  \n                                                  -0.079622  \n                                       secteursEnseignement  \n                                                  -2.687911  \n                           secteursHébergement/restauration  \n                                                   0.185856  \n                                          secteursIndustrie  \n                                                   0.081683  \n                                           secteursInfo/com  \n                                                   0.930045  \n                                      secteursManquant ou U  \n                                                   0.706231  \n                    secteursSanté humaine et action sociale  \n                                                  -0.794446  \n                                         secteursTransports  \n                                                  -0.493648  \n\nDegrees of Freedom: 123007 Total (i.e. Null);  122976 Residual\nNull Deviance:\t    129200 \nResidual Deviance: 103100 \tAIC: 103100\n```\n\n\n:::\n:::\n\n\nLa sortie n'affiche que le \"meilleur\" modèle, et c'est donc bien celui qu'on avait mis avec l'ensemble des variables.\n\nPour une sélection des variables de façon \"ascendante\", en partant d'un modèle sans variable puis on ajoute une à une les variables. On utilise la même fonction mais en changeant les paramètres et en créant un modèle \"vide\" avant :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogit_0 <- glm(CDI ~ 1, data=OffresPE_train, family=binomial(\"logit\"))\nlogit_forward <- stepAIC(logit_0, \n                         scope=list(lower=\"CDI ~ 1\", \n                         upper=\"CDI ~ mois_publication + secteurs + salary_cat\"),\n                         direction=\"forward\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=129239.4\nCDI ~ 1\n\n                   Df Deviance    AIC\n+ secteurs         15   106295 106327\n+ salary_cat        5   126029 126041\n+ mois_publication 11   128618 128642\n<none>                  129237 129239\n\nStep:  AIC=106327.2\nCDI ~ secteurs\n\n                   Df Deviance    AIC\n+ salary_cat        5   103875 103917\n+ mois_publication 11   105500 105554\n<none>                  106295 106327\n\nStep:  AIC=103917.1\nCDI ~ secteurs + salary_cat\n\n                   Df Deviance    AIC\n+ mois_publication 11   103084 103148\n<none>                  103875 103917\n\nStep:  AIC=103147.8\nCDI ~ secteurs + salary_cat + mois_publication\n```\n\n\n:::\n\n```{.r .cell-code}\nlogit_forward\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:  glm(formula = CDI ~ secteurs + salary_cat + mois_publication, \n    family = binomial(\"logit\"), data = OffresPE_train)\n\nCoefficients:\n                                                (Intercept)  \n                                                   3.317992  \n        secteursActivités des ménages en tant qu'employeurs  \n                                                  -5.551243  \n                               secteursActivités fi et immo  \n                                                  -0.002512  \n       secteursActivités services administratifs et soutien  \n                                                  -1.965045  \n         secteursActivités spé, scientifiques et techniques  \n                                                  -0.024905  \n                            secteursAdministration publique  \n                                                  -2.479553  \n          secteursArts, spectacles et activités récréatives  \n                                                  -1.560948  \n                        secteursAutres activités de service  \n                                                  -0.796736  \n                                           secteursCommerce  \n                                                  -0.079622  \n                                       secteursEnseignement  \n                                                  -2.687911  \n                           secteursHébergement/restauration  \n                                                   0.185856  \n                                          secteursIndustrie  \n                                                   0.081683  \n                                           secteursInfo/com  \n                                                   0.930045  \n                                      secteursManquant ou U  \n                                                   0.706231  \n                    secteursSanté humaine et action sociale  \n                                                  -0.794446  \n                                         secteursTransports  \n                                                  -0.493648  \n               salary_catEntre 0 et moins que le SMIC (10€)  \n                                                  -2.994267  \n                    salary_catEntre le SMIC et le Q1(11,6€)  \n                                                  -1.988778  \n                salary_catEntre le Q1 et la moyenne (20,1€)  \n                                                  -1.508541  \nsalary_catEntre la moyenne et le D9 observée en France(15€)  \n                                                  -0.550997  \n                                         salary_catManquant  \n                                                  -2.029324  \n                                      mois_publicationfévr.  \n                                                  -0.254771  \n                                       mois_publicationmars  \n                                                  -0.065913  \n                                       mois_publicationavr.  \n                                                  -0.114595  \n                                        mois_publicationmai  \n                                                  -0.413980  \n                                       mois_publicationjuin  \n                                                  -0.602573  \n                                      mois_publicationjuil.  \n                                                  -0.488606  \n                                       mois_publicationaoût  \n                                                  -0.235788  \n                                      mois_publicationsept.  \n                                                  -0.022989  \n                                       mois_publicationoct.  \n                                                   0.045417  \n                                       mois_publicationnov.  \n                                                   0.184077  \n                                       mois_publicationdéc.  \n                                                  -0.077525  \n\nDegrees of Freedom: 123007 Total (i.e. Null);  122976 Residual\nNull Deviance:\t    129200 \nResidual Deviance: 103100 \tAIC: 103100\n```\n\n\n:::\n:::\n\n\nLe taux d'AIC diminue à chaque variable ajoutée donc le meilleur modèle est bien celui avec l'ensemble des variables explicatives mises dans le modèle initial.\n\n\n\n### Le modèle final et l'interprétation des résultats\n\nFinalement, dans une visée plus explicative que prédictive, on peut estimer notre modèle sur l'ensemble de la base et étudier plus précisément les résultats avec les *odds-ratios* ou rapports des côtes par exemple pour commenter plus directement les coefficients. Ces *odds-ratios* correspondent à l’exponentiel des coefficients initiaux de la régression. Ils se lisent par rapport à 1 : il est égale à 1 si les deux côtes sont identiques donc s'il n'y a pas de différence de probabilité d'être en couple selon qu'on est une femme ou un homme, il est supérieur à 1 si ici la femme a une probabilité supérieure à celle de l'homme d'être en couple, et il est inférieur à 1 si la femme a une probabilité inférieure à celle de l'homme d'être en couple.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogit_VF <- glm (CDI ~ mois_publication + secteurs + salary_cat,\n                 data=OffresPE_reg, \n                 family = binomial(\"logit\"))\nsummary(logit_VF)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = CDI ~ mois_publication + secteurs + salary_cat, \n    family = binomial(\"logit\"), data = OffresPE_reg)\n\nCoefficients:\n                                                            Estimate Std. Error\n(Intercept)                                                  3.30724    0.11585\nmois_publicationfévr.                                       -0.24882    0.02816\nmois_publicationmars                                        -0.08493    0.03020\nmois_publicationavr.                                        -0.14604    0.03481\nmois_publicationmai                                         -0.44965    0.03356\nmois_publicationjuin                                        -0.60217    0.02931\nmois_publicationjuil.                                       -0.51310    0.02866\nmois_publicationaoût                                        -0.24978    0.03016\nmois_publicationsept.                                       -0.03594    0.02952\nmois_publicationoct.                                         0.03782    0.02966\nmois_publicationnov.                                         0.12515    0.03592\nmois_publicationdéc.                                        -0.11433    0.03625\nsecteursActivités des ménages en tant qu'employeurs         -5.48375    0.16835\nsecteursActivités fi et immo                                 0.05077    0.11449\nsecteursActivités services administratifs et soutien        -1.93861    0.10133\nsecteursActivités spé, scientifiques et techniques          -0.01373    0.10501\nsecteursAdministration publique                             -2.44177    0.12610\nsecteursArts, spectacles et activités récréatives           -1.55451    0.15528\nsecteursAutres activités de service                         -0.77534    0.11004\nsecteursCommerce                                            -0.07397    0.11182\nsecteursEnseignement                                        -2.68917    0.11107\nsecteursHébergement/restauration                             0.21455    0.12019\nsecteursIndustrie                                            0.09091    0.12411\nsecteursInfo/com                                             0.98187    0.11908\nsecteursManquant ou U                                        0.74847    0.10171\nsecteursSanté humaine et action sociale                     -0.77013    0.10452\nsecteursTransports                                          -0.36407    0.16240\nsalary_catEntre 0 et moins que le SMIC (10€)                -3.01931    0.08534\nsalary_catEntre le SMIC et le Q1(11,6€)                     -1.98949    0.06406\nsalary_catEntre le Q1 et la moyenne (20,1€)                 -1.52587    0.05904\nsalary_catEntre la moyenne et le D9 observée en France(15€) -0.60596    0.06488\nsalary_catManquant                                          -2.03906    0.05817\n                                                            z value Pr(>|z|)\n(Intercept)                                                  28.547  < 2e-16\nmois_publicationfévr.                                        -8.837  < 2e-16\nmois_publicationmars                                         -2.812 0.004919\nmois_publicationavr.                                         -4.195 2.72e-05\nmois_publicationmai                                         -13.397  < 2e-16\nmois_publicationjuin                                        -20.547  < 2e-16\nmois_publicationjuil.                                       -17.900  < 2e-16\nmois_publicationaoût                                         -8.282  < 2e-16\nmois_publicationsept.                                        -1.217 0.223428\nmois_publicationoct.                                          1.275 0.202174\nmois_publicationnov.                                          3.485 0.000493\nmois_publicationdéc.                                         -3.154 0.001610\nsecteursActivités des ménages en tant qu'employeurs         -32.573  < 2e-16\nsecteursActivités fi et immo                                  0.443 0.657406\nsecteursActivités services administratifs et soutien        -19.131  < 2e-16\nsecteursActivités spé, scientifiques et techniques           -0.131 0.895944\nsecteursAdministration publique                             -19.363  < 2e-16\nsecteursArts, spectacles et activités récréatives           -10.011  < 2e-16\nsecteursAutres activités de service                          -7.046 1.84e-12\nsecteursCommerce                                             -0.661 0.508325\nsecteursEnseignement                                        -24.211  < 2e-16\nsecteursHébergement/restauration                              1.785 0.074251\nsecteursIndustrie                                             0.733 0.463861\nsecteursInfo/com                                              8.246  < 2e-16\nsecteursManquant ou U                                         7.359 1.86e-13\nsecteursSanté humaine et action sociale                      -7.368 1.73e-13\nsecteursTransports                                           -2.242 0.024972\nsalary_catEntre 0 et moins que le SMIC (10€)                -35.378  < 2e-16\nsalary_catEntre le SMIC et le Q1(11,6€)                     -31.057  < 2e-16\nsalary_catEntre le Q1 et la moyenne (20,1€)                 -25.844  < 2e-16\nsalary_catEntre la moyenne et le D9 observée en France(15€)  -9.340  < 2e-16\nsalary_catManquant                                          -35.052  < 2e-16\n                                                               \n(Intercept)                                                 ***\nmois_publicationfévr.                                       ***\nmois_publicationmars                                        ** \nmois_publicationavr.                                        ***\nmois_publicationmai                                         ***\nmois_publicationjuin                                        ***\nmois_publicationjuil.                                       ***\nmois_publicationaoût                                        ***\nmois_publicationsept.                                          \nmois_publicationoct.                                           \nmois_publicationnov.                                        ***\nmois_publicationdéc.                                        ** \nsecteursActivités des ménages en tant qu'employeurs         ***\nsecteursActivités fi et immo                                   \nsecteursActivités services administratifs et soutien        ***\nsecteursActivités spé, scientifiques et techniques             \nsecteursAdministration publique                             ***\nsecteursArts, spectacles et activités récréatives           ***\nsecteursAutres activités de service                         ***\nsecteursCommerce                                               \nsecteursEnseignement                                        ***\nsecteursHébergement/restauration                            .  \nsecteursIndustrie                                              \nsecteursInfo/com                                            ***\nsecteursManquant ou U                                       ***\nsecteursSanté humaine et action sociale                     ***\nsecteursTransports                                          *  \nsalary_catEntre 0 et moins que le SMIC (10€)                ***\nsalary_catEntre le SMIC et le Q1(11,6€)                     ***\nsalary_catEntre le Q1 et la moyenne (20,1€)                 ***\nsalary_catEntre la moyenne et le D9 observée en France(15€) ***\nsalary_catManquant                                          ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 185001  on 175776  degrees of freedom\nResidual deviance: 147194  on 175745  degrees of freedom\nAIC: 147258\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Résumé des résultats sous forme de tableau avec les odds-ratio\n# avec la librairie \"questionr\" d'abord\n#install.packages(questionr)\nlibrary(questionr)\nodds.ratio(logit_VF)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                                    OR\n(Intercept)                                                 27.3097637\nmois_publicationfévr.                                        0.7797184\nmois_publicationmars                                         0.9185751\nmois_publicationavr.                                         0.8641212\nmois_publicationmai                                          0.6378516\nmois_publicationjuin                                         0.5476211\nmois_publicationjuil.                                        0.5986356\nmois_publicationaoût                                         0.7789698\nmois_publicationsept.                                        0.9647007\nmois_publicationoct.                                         1.0385477\nmois_publicationnov.                                         1.1333210\nmois_publicationdéc.                                         0.8919606\nsecteursActivités des ménages en tant qu'employeurs          0.0041537\nsecteursActivités fi et immo                                 1.0520854\nsecteursActivités services administratifs et soutien         0.1439036\nsecteursActivités spé, scientifiques et techniques           0.9863594\nsecteursAdministration publique                              0.0870065\nsecteursArts, spectacles et activités récréatives            0.2112921\nsecteursAutres activités de service                          0.4605475\nsecteursCommerce                                             0.9287039\nsecteursEnseignement                                         0.0679374\nsecteursHébergement/restauration                             1.2392996\nsecteursIndustrie                                            1.0951743\nsecteursInfo/com                                             2.6694362\nsecteursManquant ou U                                        2.1137596\nsecteursSanté humaine et action sociale                      0.4629528\nsecteursTransports                                           0.6948414\nsalary_catEntre 0 et moins que le SMIC (10€)                 0.0488349\nsalary_catEntre le SMIC et le Q1(11,6€)                      0.1367656\nsalary_catEntre le Q1 et la moyenne (20,1€)                  0.2174313\nsalary_catEntre la moyenne et le D9 observée en France(15€)  0.5455530\nsalary_catManquant                                           0.1301509\n                                                                 2.5 %  97.5 %\n(Intercept)                                                 21.8301319 34.3862\nmois_publicationfévr.                                        0.7378481  0.8240\nmois_publicationmars                                         0.8658132  0.9746\nmois_publicationavr.                                         0.8072490  0.9253\nmois_publicationmai                                          0.5972947  0.6813\nmois_publicationjuin                                         0.5170505  0.5800\nmois_publicationjuil.                                        0.5659256  0.6332\nmois_publicationaoût                                         0.7342813  0.8264\nmois_publicationsept.                                        0.9104943  1.0222\nmois_publicationoct.                                         0.9799306  1.1007\nmois_publicationnov.                                         1.0564530  1.2162\nmois_publicationdéc.                                         0.8309011  0.9578\nsecteursActivités des ménages en tant qu'employeurs          0.0029590  0.0057\nsecteursActivités fi et immo                                 0.8382415  1.3134\nsecteursActivités services administratifs et soutien         0.1175189  0.1749\nsecteursActivités spé, scientifiques et techniques           0.7999653  1.2078\nsecteursAdministration publique                              0.0677434  0.1111\nsecteursArts, spectacles et activités récréatives            0.1555374  0.2860\nsecteursAutres activités de service                          0.3699870  0.5697\nsecteursCommerce                                             0.7436415  1.1531\nsecteursEnseignement                                         0.0544604  0.0842\nsecteursHébergement/restauration                             0.9769527  1.5654\nsecteursIndustrie                                            0.8570178  1.3945\nsecteursInfo/com                                             2.1089431  3.3646\nsecteursManquant ou U                                        1.7250020  2.5709\nsecteursSanté humaine et action sociale                      0.3758147  0.5663\nsecteursTransports                                           0.5059636  0.9569\nsalary_catEntre 0 et moins que le SMIC (10€)                 0.0412884  0.0577\nsalary_catEntre le SMIC et le Q1(11,6€)                      0.1205062  0.1549\nsalary_catEntre le Q1 et la moyenne (20,1€)                  0.1934430  0.2438\nsalary_catEntre la moyenne et le D9 observée en France(15€)  0.4799834  0.6190\nsalary_catManquant                                           0.1159809  0.1457\n                                                                    p    \n(Intercept)                                                 < 2.2e-16 ***\nmois_publicationfévr.                                       < 2.2e-16 ***\nmois_publicationmars                                        0.0049192 ** \nmois_publicationavr.                                        2.724e-05 ***\nmois_publicationmai                                         < 2.2e-16 ***\nmois_publicationjuin                                        < 2.2e-16 ***\nmois_publicationjuil.                                       < 2.2e-16 ***\nmois_publicationaoût                                        < 2.2e-16 ***\nmois_publicationsept.                                       0.2234285    \nmois_publicationoct.                                        0.2021744    \nmois_publicationnov.                                        0.0004929 ***\nmois_publicationdéc.                                        0.0016096 ** \nsecteursActivités des ménages en tant qu'employeurs         < 2.2e-16 ***\nsecteursActivités fi et immo                                0.6574059    \nsecteursActivités services administratifs et soutien        < 2.2e-16 ***\nsecteursActivités spé, scientifiques et techniques          0.8959441    \nsecteursAdministration publique                             < 2.2e-16 ***\nsecteursArts, spectacles et activités récréatives           < 2.2e-16 ***\nsecteursAutres activités de service                         1.843e-12 ***\nsecteursCommerce                                            0.5083248    \nsecteursEnseignement                                        < 2.2e-16 ***\nsecteursHébergement/restauration                            0.0742507 .  \nsecteursIndustrie                                           0.4638614    \nsecteursInfo/com                                            < 2.2e-16 ***\nsecteursManquant ou U                                       1.856e-13 ***\nsecteursSanté humaine et action sociale                     1.728e-13 ***\nsecteursTransports                                          0.0249718 *  \nsalary_catEntre 0 et moins que le SMIC (10€)                < 2.2e-16 ***\nsalary_catEntre le SMIC et le Q1(11,6€)                     < 2.2e-16 ***\nsalary_catEntre le Q1 et la moyenne (20,1€)                 < 2.2e-16 ***\nsalary_catEntre la moyenne et le D9 observée en France(15€) < 2.2e-16 ***\nsalary_catManquant                                          < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n<!-- ![ ](images/Graphique_Odds-ratio.png) -->\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# puis avec la librarie \"forestmodel\" pour avoir un meilleur rendu\n#install.packages(\"forestmodel\")\nlibrary(forestmodel)\nforest_model(logit_VF, \n             format_options = forest_model_format_options(point_size=2)) +\n  theme(axis.text.x = element_text(size=7, face=\"bold\"))\n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n<!-- ![ ](images/Graphique_Forest_model.png) -->\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ou encore avec \"gt_summary\" pour avoir un autre rendu\nlibrary(gtsummary)\ntheme_gtsummary_language(\"fr\", decimal.mark = \",\", big.mark=\" \")\nlogit_VF %>% \n  tbl_regression(exponentiate = TRUE) %>% \n  add_global_p(keep=TRUE) %>% \n  modify_header(label ~ \"**Variable**\") %>% \n  modify_caption(\"**Tableau de résultats. Variables expliquant le fait qu'une offre d'emploi soit en CDI dans le 75**\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"wejeeikajw\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#wejeeikajw table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#wejeeikajw thead, #wejeeikajw tbody, #wejeeikajw tfoot, #wejeeikajw tr, #wejeeikajw td, #wejeeikajw th {\n  border-style: none;\n}\n\n#wejeeikajw p {\n  margin: 0;\n  padding: 0;\n}\n\n#wejeeikajw .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#wejeeikajw .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#wejeeikajw .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#wejeeikajw .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#wejeeikajw .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#wejeeikajw .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#wejeeikajw .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#wejeeikajw .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#wejeeikajw .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#wejeeikajw .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#wejeeikajw .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#wejeeikajw .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#wejeeikajw .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#wejeeikajw .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#wejeeikajw .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wejeeikajw .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#wejeeikajw .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#wejeeikajw .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#wejeeikajw .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wejeeikajw .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#wejeeikajw .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wejeeikajw .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#wejeeikajw .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wejeeikajw .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#wejeeikajw .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#wejeeikajw .gt_left {\n  text-align: left;\n}\n\n#wejeeikajw .gt_center {\n  text-align: center;\n}\n\n#wejeeikajw .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#wejeeikajw .gt_font_normal {\n  font-weight: normal;\n}\n\n#wejeeikajw .gt_font_bold {\n  font-weight: bold;\n}\n\n#wejeeikajw .gt_font_italic {\n  font-style: italic;\n}\n\n#wejeeikajw .gt_super {\n  font-size: 65%;\n}\n\n#wejeeikajw .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#wejeeikajw .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#wejeeikajw .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#wejeeikajw .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#wejeeikajw .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#wejeeikajw .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#wejeeikajw .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#wejeeikajw .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#wejeeikajw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"KipUYWJsZWF1IGRlIHLDqXN1bHRhdHMuIFZhcmlhYmxlcyBleHBsaXF1YW50IGxlIGZhaXQgcXUndW5lIG9mZnJlIGQnZW1wbG9pIHNvaXQgZW4gQ0RJIGRhbnMgbGUgNzUqKg==\"><span class='gt_from_md'><strong>Tableau de résultats. Variables expliquant le fait qu’une offre d’emploi soit en CDI dans le 75</strong></span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipWYXJpYWJsZSoq\"><span class='gt_from_md'><strong>Variable</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\"><span data-qmd-base64=\"KipPUioq\"><span class='gt_from_md'><strong>OR</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\"><span data-qmd-base64=\"Kio5NSUgSUMqKg==\"><span class='gt_from_md'><strong>95% IC</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\"><span data-qmd-base64=\"KipwLXZhbGV1cioq\"><span class='gt_from_md'><strong>p-valeur</strong></span></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">mois_publication</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    janv.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    févr.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,78</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,74 – 0,82</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    mars</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,92</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,87 – 0,97</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,005</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    avr.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,86</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,81 – 0,93</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    mai</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,64</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,60 – 0,68</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    juin</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,55</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,52 – 0,58</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    juil.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,60</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,57 – 0,63</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    août</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,78</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,73 – 0,83</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    sept.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,96</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,91 – 1,02</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,2</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    oct.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1,04</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,98 – 1,10</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,2</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    nov.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1,13</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1,06 – 1,22</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    déc.</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,89</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,83 – 0,96</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,002</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">secteurs</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Construction</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Activités des ménages en tant qu'employeurs</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,00</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,00 – 0,01</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Activités fi et immo</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1,05</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,84 – 1,31</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,7</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Activités services administratifs et soutien</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,14</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,12 – 0,17</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Activités spé, scientifiques et techniques</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,99</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,80 – 1,21</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,9</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Administration publique</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,09</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,07 – 0,11</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Arts, spectacles et activités récréatives</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,21</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,16 – 0,29</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Autres activités de service</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,46</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,37 – 0,57</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Commerce</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,93</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,74 – 1,15</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,5</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Enseignement</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,07</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,05 – 0,08</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Hébergement/restauration</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1,24</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,98 – 1,57</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,074</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Industrie</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">1,10</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,86 – 1,39</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,5</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Info/com</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2,67</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">2,11 – 3,36</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Manquant ou U</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">2,11</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">1,73 – 2,57</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Santé humaine et action sociale</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,46</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,38 – 0,57</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transports</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,69</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,51 – 0,96</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\">0,025</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">salary_cat</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Entre le D9 et le maximum (40200€)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">—</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">—</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Entre 0 et moins que le SMIC (10€)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,05</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,04 – 0,06</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Entre le SMIC et le Q1(11,6€)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,14</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,12 – 0,15</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Entre le Q1 et la moyenne (20,1€)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,22</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,19 – 0,24</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Entre la moyenne et le D9 observée en France(15€)</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,55</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,48 – 0,62</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Manquant</td>\n<td headers=\"estimate\" class=\"gt_row gt_center\">0,13</td>\n<td headers=\"conf.low\" class=\"gt_row gt_center\">0,12 – 0,15</td>\n<td headers=\"p.value\" class=\"gt_row gt_center\"><0,001</td></tr>\n  </tbody>\n  <tfoot>\n    <tr class=\"gt_sourcenotes\">\n      <td class=\"gt_sourcenote\" colspan=\"4\"><span data-qmd-base64=\"QWJyw6l2aWF0aW9uczogSUMgPSBpbnRlcnZhbGxlIGRlIGNvbmZpYW5jZSwgT1IgPSByYXBwb3J0IGRlIGNvdGVz\"><span class='gt_from_md'>Abréviations: IC = intervalle de confiance, OR = rapport de cotes</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n:::\n\n\nOn privilégiera plutôt les deux derniers types de tableaux : ainsi, on note que la probabilité qu'une offre d'emploi soit en CDI est 1,24 fois plus élevée si l'emploi est dans le secteur de l'hébergement/restauration et 2,67 fois plus élevée dans le secteur de l'information/communication. Concernant le salaire, par rapport à la référence \"Entre le D9 et le maximum (40200€)\", si l'offre d'emploi se situe dans une tranche de salaire plus faible, alors la probabilité que cette offre soit en CDI est plus faible, de 0,05 fois à 0,55 fois, soit une baisse de 45% `((1-0,55)*100)` à 95% `((1-0,05)*100)`. Par rapport au mois de janvier, là aussi, la probabilité qu'une offre d'emploi soit en CDI est plus faible pour tous les autres mois sauf novembre, les odds-ratio étant toujours inférieurs à 1.\n\nOn peut aussi vouloir visualiser ces résultats, on peut pour cela utiliser la librarie **`GGally`** et la fonction `ggcoef_model()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Résumé des résultats sous forme graphqiue\nlibrary(GGally)\nggcoef_model(logit_VF, exponentiate = TRUE) +\n  ggtitle(\"Variables expliquant le fait \\nqu'une offre d'emploi soit en \\nCDI dans le 75\")+\n  theme(plot.title = element_text(size=10))\n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nC'est peut-être le meilleur rendu...\n\n## Un modèle à visée principale prédictive : l'abre de décision\n\nOn va procéder à la même analyse en cherchant, cette fois, à prédire si une offre d'emploi sera en CDI ou non à partir des variables sélectionnées précédemment.\\\nOn repart donc des deux tables créées et on va utiliser un modèle dit d'apprentissage supervisé, l'abre de décision. Sa construction repose sur un partitionnement récursif des observations qui se fait à partir de noeuds coupés, ces coupures pourront répondre à des règles et des conditions à spécifier ou faire varier pour avoir un meilleur modèle.\\\nIci on va utiliser un arbre de classification puisque notre variable est qualitative (binaire).\n\nC'est le package **`rpart`** qui est spécialisé dans les modèles d'arbres de décision, à installer donc d'abord puis à appeler dans la librairie ; le package **`rpart.plot`** permet, lui, d'avoir un arbre plus esthétique et informatif.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"rpart\")\n# install.packages(\"rpart.plot\")\nlibrary(rpart)\nlibrary(rpart.plot)\n```\n:::\n\n\n### Le modèle initial\n\nLa spécification du modèle est assez simple, on précise la variable d'intérêt, les éventuelles variables explicatives ou toutes celles qui sont dans la table avec le `.` (comme précédemment pour le modèle logit), la base de données sur laquelle appliquer le modèle, et dans l'argument `method=` on spécifie le type de modèle, soit \"class\" pour une variable d'intérêt qualitative ou binaire, soit \"anova\" pour une variable d'intérêt quantitative ou continue.\n\nOn va d'abord appliquer le modèle sur notre échantillon d'apprentissage ou d'entraînement :\n\n\n::: {.cell}\n\n```{.r .cell-code}\narbre_1 <- rpart(CDI ~ ., \n                 data=OffresPE_train, \n                 method=\"class\")\narbre_1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nn= 123008 \n\nnode), split, n, loss, yval, (yprob)\n      * denotes terminal node\n\n 1) root 123008 26908 Oui (0.2187500 0.7812500)  \n   2) secteurs=Activités des ménages en tant qu'employeurs,Activités services administratifs et soutien,Administration publique,Arts, spectacles et activités récréatives,Enseignement 16072  5205 Non (0.6761448 0.3238552)  \n     4) salary_cat=Entre 0 et moins que le SMIC (10€),Manquant 7859   881 Non (0.8878992 0.1121008) *\n     5) salary_cat=Entre le D9 et le maximum (40200€),Entre le SMIC et le Q1(11,6€),Entre le Q1 et la moyenne (20,1€),Entre la moyenne et le D9 observée en France(15€) 8213  3889 Oui (0.4735176 0.5264824)  \n      10) salary_cat=Entre le SMIC et le Q1(11,6€),Entre le Q1 et la moyenne (20,1€) 5556  2415 Non (0.5653348 0.4346652) *\n      11) salary_cat=Entre le D9 et le maximum (40200€),Entre la moyenne et le D9 observée en France(15€) 2657   748 Oui (0.2815205 0.7184795) *\n   3) secteurs=Construction,Activités fi et immo,Activités spé, scientifiques et techniques,Autres activités de service,Commerce,Hébergement/restauration,Industrie,Info/com,Manquant ou U,Santé humaine et action sociale,Transports 106936 16041 Oui (0.1500056 0.8499944) *\n```\n\n\n:::\n:::\n\n\nLe modèle nous donne d'abord les résultats en format texte, ce sont des indications sur les différentes \"noeuds\" puis \"branches\" de l'arbre, etc. : \"node\" pour noeud et son numéro, \"split\" pour la condition de coupure/le critère de décision, \"n\" pour le nombre total d'observations dans un noeud, \"loss\" le nombre d'observations qui n'appartient pas à la modalité prédite, \"yval\" la modalité prédite pour les individus présents à l'étape du noeud, et \"yprob\" la proportion d'observations pour les individus présents à l'étape du noeud qui prend la valeur prédite en seconde position. Le petit astérix \"\\*\" précise que le noeud est une feuille (\"terminal\").\n\nPar exemple, ici le premier noeud indiqué \"root\" représente l'ensemble de l'échantillon (c'est la \"racine\" de l'arbre), soit environ 123 000 observations, et comme la modalité prédite est \"Oui\", il y a 78% d'offres d'emploi qui sont en CDI, contre 22% qui le sont pas soit environ 27 000 observations (celles qu'on perd à cette étape donc). La première variable discriminante est le secteur d'activité : celles qui se situent dans les secteurs \"Activités des ménages en tant qu'employeurs\", ou \"Activités services administratifs et soutien\", ou \"Administration publique\", ou \"Arts, spectacles et activités récréatives\", ou encore \"Enseignement\" forment une première branche et un groupe d'offres qui ne sont pas en CDI, alors que les secteurs de la \"Construction\", ou des \"Activités fi et immo\", ou des \"Activités spé, scientifiques et techniques\", ou des \"Autres activités de service\", ou du \"Commerce\", ou de l'\"Hébergement/restauration\", ou de l'\"Industrie\", ou de l'\"Info/com\", ou \"manquant ou U\", ou de la \"Santé humaine et action sociale\", et enfin des \"Transports\" forment l'autre branche et un groupe d'offres en CDI. Ensuite, pour le premier groupe de secteurs, une autre division se forme selon le niveau de salaire : si l'offre propose un salaire \"Entre 0 et moins que le SMIC (10€)\" ou est manquant un autre groupe va se former qui ne sera pas en CDI, alors que si l'offre propose un salaire au-dessus du SMIC alors l'offre sera en CDI, ce dernier groupe se divisera lui-même encore en deux groupes selon d'autres modalités du salaire.\n\nOn peut regarder quelles sont les variables les plus importantes dans le modèle par ordre :\n\n\n::: {.cell}\n\n```{.r .cell-code}\narbre_1$variable.importance\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        secteurs       salary_cat mois_publication \n       8264.5018        1668.7772         114.5921 \n```\n\n\n:::\n:::\n\n\nLe secteur d'activité est la variable la plus discriminante, comme on l'avait supposé puisque c'était la première variable qui divisait notre échantillon, ensuite vient le niveau de salaire et enfin le mois de publication de l'offre.\\\n\\\n\nOn va mieux étudier cela avec le résultat visuel.\\\nPour avoir ainsi graphiquement l'arbre, il faut appeler la fonction `rpart.plot()` du même package, l'argument \"extra\" permettant de préciser le type de modèle : \"106\" pour des modèles en classes avec une variable qualitative et binaire, \"104\" pour des modèles en classes mais avec une variable d'intérêt qualitative avec plus de 2 modalités, et \"100\" pour les autres modèles.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# On dessine l'arbre\nrpart.plot(arbre_1, extra=106,\n           faclen = 8,  # abrège les modalités de variables\n           cex = 0.75)  # permet de réduire la taille du texte\n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# ou avec la librarie `rattle`\n#install.packages(\"rattle\")\nlibrary(rattle)\nfancyRpartPlot(arbre_1) \n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\n\nAu sommet de l'arbre on a donc la racine (qui est le 1er noeud), puis il se divise en 2 branches pour aboutir à deux autres noeuds, etc.\\\nOn voit donc que la branche partant sur la gauche, c'est le cas où la variable de secteurs est égale aux modalités \"Activités des ménages en tant qu'employeurs\", ou \"Activités services administratifs et soutien\", ou \"Administration publique\", ou \"Arts, spectacles et activités récréatives\", ou \"Enseignement\" (on voit un \"yes\" qui est encadré ; ça sera le cas à chaque fois même si ce n'est pas de nouveau inscrit, autrement dit la branche partant sur la gauche sera la modalité \"oui\" de la variable).\\\nIl y a chaque fois 3 données indiquées :\n\n-   d'abord, la modalité prédite par le modèle lorsqu'on est dans le groupe considéré, par exemple pour la feuille terminale à droite, donc pour les autres secteurs d'activité que ceux indiqués, la modalité prédite sera le \"oui\" donc une offre en CDI, on pourra vérifier dans les données en récupérant la modalité prédite pour chaque observation, c'est-à-dire pour toutes les offres se situant dans ces secteurs, la modalité prédite est bien \"oui\" ;\n-   ensuite, parmi les offres de ce groupe, 85% sont en CDI, ;\n-   et enfin, ces secteurs représentent 87% de la population (de notre base d'apprentissage).\\\n    Autrement dit, 87% des offres se situent dans ces secteurs avec une probabilité d'être en CDI de 85%.\n\nL'autre branche indique les offres qui prennent les modalités \"Activités des ménages en tant qu'employeurs\", ou \"Activités services administratifs et soutien\", ou \"Administration publique\", ou \"Arts, spectacles et activités récréatives\", ou encore \"Enseignement\" de la variable de secteurs, elles représentent 13% de la base et la probabilité prédite qu'elles soient en CDI sera de 32%.\\\nTout en bas, se trouvent les feuilles de l'arbre, c'est lorsqu'il n'y a plus aucune branche qui part du noeud en question.\n\nAinsi, 5% de la base (d'apprentissage) représentent des offres d'emploi des secteurs \"Activités des ménages en tant qu'employeurs\", ou \"Activités services administratifs et soutien\", ou \"Administration publique\", ou \"Arts, spectacles et activités récréatives\", ou encore \"Enseignement\", avec des niveaux de salaire \"Entre le SMIC et le Q1(11,6€)\" ou \"Entre le Q1 et la moyenne (20,1€)\", qui ont une probabilité de 42% d'être en CDI.\n\n### L'évaluation du modèle\n\nDe la même façon que précédemment, on peut vérifier la bonne (ou non) prédiction du modèle en l'appliquant sur l'échantillon dit test, puis en comparant les proportions prédites avec celles effectivement observées dans la base dans la matrice de confusion et enfin en calculant un taux de concordance ou au contraire un taux d'erreur à partir de cette une matrice de confusion :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modèle appliqué sur l'échantillon test\npredict_test <- predict(arbre_1, OffresPE_test, type=\"class\")\n\n# Comparaison des résultats - Matrice de confusion\nmat_confusion <- table(OffresPE_test$CDI, predict_test)\nmat_confusion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     predict_test\n        Non   Oui\n  Non  4484  7186\n  Oui  1415 39684\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taux de concordance : rapport entre la somme des éléments \n# de la diagonale principale et la somme des observations \n# totales (soit de la matrice)\ntx_concordance <- sum(diag(mat_confusion) / sum(mat_confusion))\ntx_concordance * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 83.70066\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taux d'erreur\ntx_erreur <- (mat_confusion[2,1] + mat_confusion[1, 2]) / sum(mat_confusion)\ntx_erreur * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16.29934\n```\n\n\n:::\n:::\n\n\nOn peut regarder aussi ce que cela donne sur la base d'apprentissage.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredict_train <- predict(arbre_1, OffresPE_train, type=\"class\")\nmat_confusion_1 <- table(OffresPE_train$CDI, predict_train)\nmat_confusion_1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     predict_train\n        Non   Oui\n  Non 10119 16789\n  Oui  3296 92804\n```\n\n\n:::\n\n```{.r .cell-code}\ntx_erreur_1 <- (mat_confusion_1[2,1] + mat_confusion_1[1, 2]) / sum(mat_confusion_1)\ntx_erreur_1 * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16.32821\n```\n\n\n:::\n:::\n\n\nDans les deux cas, les taux d'erreur sont relativement faible, d'environ 16%. Le modèle ne prédit pas trop mal. On peut noter qu'on a pratiquement le même taux d'erreur que le modèle logit réalisé précédemment...\n\nVérifions si nous pouvons l'améliorer en modifiant les paramètres de construction de l'arbre, c'est-à-dire en jouant sur les conditions de coupure d'un noeud et sur les règles d'arrêt de ces coupures. On l'effectue avec la fonction `rpart.control()` avec les arguments suivants (règles d'arrêt principalement) : `minsplit=` donne le nombre minimum d'observations (individus) présentes à l'étape d'un noeud pour envisager une coupure ; `minbucket=` qui donne le nombre minimum d'observations/individus présentes à l'étape d'un noeud qu'engendrerait la coupure du noeud parent ; `maxdepth` qui donne la profondeur de l'arbre ; et `cp=` qui est un paramètre de complexité (plus il est petit, plus grand est l'arbre de régression).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Définition des règles de décision\najust_param <- rpart.control(minsplit = 50, minbucket = 50, maxdepth = 10, cp=0)\n\n# Ajustement du modèle en indiquant le paramètre \"control\"\narbre_2 <- rpart(CDI ~ mois_publication + secteurs + salary_cat, \n                 data=OffresPE_train, method=\"class\", \n                 control = ajust_param)\n\n# On étudie de nouveau la matrice de confusion et \n# le taux d'erreur associé au nouveau modèle sur la base test\npredict_test_1 <- predict(arbre_2, OffresPE_test, type=\"class\")\nmat_confusion_ajust <- table(OffresPE_test$CDI, predict_test_1)\nmat_confusion_ajust\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     predict_test_1\n        Non   Oui\n  Non  4358  7312\n  Oui  1139 39960\n```\n\n\n:::\n\n```{.r .cell-code}\ntx_erreur_1 <- (mat_confusion_ajust[2,1] + mat_confusion_ajust[1, 2]) / sum(mat_confusion_ajust) *100\ntx_erreur_1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16.01508\n```\n\n\n:::\n:::\n\n\nOn peut l'appliquer de même à l'échantillon d'apprentissage :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modèle appliqué sur l'échantillon test\npredict_train <- predict(arbre_2, OffresPE_train, type=\"class\")\n\n# Comparaison des résultats - Matrice de confusion\nmat_confusion_ajust1 <- table(OffresPE_train$CDI, predict_train)\nmat_confusion_ajust1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     predict_train\n        Non   Oui\n  Non  9956 16952\n  Oui  2544 93556\n```\n\n\n:::\n\n```{.r .cell-code}\n# Taux d'erreur\ntx_erreur_2 <- (mat_confusion_ajust1[2,1] + mat_confusion_ajust1[1, 2]) / sum(mat_confusion_ajust1)* 100\ntx_erreur_2 \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 15.84938\n```\n\n\n:::\n:::\n\n\nLe taux d'erreur est un peu plus faible, la différence est légère, mais c'est toujours ça de pris !\n\nL'arbre correspondant est le suivant:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrpart.plot(arbre_2, extra=106)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: labs do not fit even at cex 0.15, there may be some overplotting\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\nOn voit qu'il n'est absolument pas lisible car plus profond, mais il prédit mieux (mais peut-être trop bien - cf. risque de surapprentissage en *matching learning*).\n\n````{=html}\n<!--Enfin, on peut chercher à minimiser l'erreur de prédiction de l'arbre afin de définir le niveau d'élagage optimal permettant ensuite de simplifier l'arbre.\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2 fonctions liées à l'argument \"cp=\" de notre modèle\nprintcp(arbre_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nClassification tree:\nrpart(formula = CDI ~ ., data = OffresPE_train, method = \"class\")\n\nVariables actually used in tree construction:\n[1] salary_cat secteurs  \n\nRoot node error: 26908/123008 = 0.21875\n\nn= 123008 \n\n        CP nsplit rel error  xerror      xstd\n1 0.210421      0   1.00000 1.00000 0.0053883\n2 0.021574      1   0.78958 0.78958 0.0049270\n3 0.010000      3   0.74643 0.74643 0.0048177\n```\n\n\n:::\n\n```{.r .cell-code}\nplotcp(arbre_1)\n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\nIci il faut donc indiquer la valeur 0.010 dans l'argument `cp=` pour minimiser l'erreur relative, c'est notre nouvelle règle d'arrêt. On va par conséquent reconstruire l'abre à partir de la fonction `prune()` en indiquant cette valeur optimale pour l'élaguer :  \n\n::: {.cell}\n\n```{.r .cell-code}\nmin(arbre_1$cptable[, \"xerror\"]) + (1*arbre_1$cptable[ which.min(arbre_1$cptable[, \"xerror\"]), \"xstd\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.75125\n```\n\n\n:::\n\n```{.r .cell-code}\nopt <- which.min(arbre_1$cptable[, \"xerror\"])\nopt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n3 \n3 \n```\n\n\n:::\n\n```{.r .cell-code}\ncp <- arbre_1$cptable[opt, \"CP\"]\n\narbre_VF <- prune(arbre_1, cp=cp)\nrpart.plot(arbre_VF)\n```\n\n::: {.cell-output-display}\n![](13-Modeles-regression_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\nCela ne change en réalité rien ici ! -->\n````\n\nVous pouvez réitérer l'exercice en introduisant d'autres variables dans l'analyse, en changeant la variable cible, etc.\n\nPour aller plus loin, on utilise maintenant beaucoup en analyse prédictive les forêts d'arbre de décision, qui constituent comme son nom l'indique, un ensemble d'arbres de régression, ce qui permet d'avoir un taux d'erreur global moindre, car la principale critique de l'arbre de décision est son potentiel d'erreur.\n",
    "supporting": [
      "13-Modeles-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}